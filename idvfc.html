<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Incidencia Federal (IDVFC) - SESNSP México</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/snapshots.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>

<body>
    <header class="header">
        <div class="container">
            <h1>Incidencia Federal (IDVFC)</h1>
            <p class="subtitle">Secretariado Ejecutivo del Sistema Nacional de Seguridad Pública</p>
            <p class="update-date">Última actualización: Agosto 2025</p>
        </div>
    </header>

    <!-- Barra de navegación con pestañas -->
    <nav class="tabs-navigation">
        <div class="container">
            <div class="tabs-container">
                <a href="https://sebrodriguezh.github.io/Cifras-de-Incidencia-Delictiva-Federal-2012---2025/" class="tab-link" target="_blank">
                    <span class="tab-text">INCIDENCIA FEDERAL (EXTERNO)</span>
                </a>
                <a href="index.html" class="tab-link">
                    <span class="tab-text">INCIDENCIA ESTATAL (CASOS)</span>
                </a>
                <a href="#" class="tab-link active">
                    <span class="tab-text">INCIDENCIA ESTATAL (VÍCTIMAS)</span>
                </a>
            </div>
        </div>
    </nav>

    <main class="main-content">
        <div class="container">
            <!-- Incidencia Federal (IDVFC) -->
            <section id="idvfc" class="section">
                <h2>Incidencia Federal (IDVFC)</h2>

                <!-- Gráfica 1: Evolución de la violencia homicida a nivel nacional (2019-2025) -->
                <div class="chart-container">
                    <h3>Gráfica 1. Evolución de la violencia homicida a nivel nacional (2019-2025)</h3>
                    <p class="chart-subtitle">Casos registrados de enero a julio por año</p>
                    <canvas id="chart-violencia-homicida-idvfc"></canvas>
                </div>

                <!-- Tabla 1: Valores mensuales de la violencia homicida a nivel nacional (2019-2025) -->
                <div class="table-container">
                    <h3>Tabla 1. Violencia homicida por tipo de delito (2019-2025)</h3>
                    <p class="chart-subtitle">Casos registrados de enero a julio por año</p>
                    <div id="tabla-violencia-homicida-idvfc"></div>
                </div>

                <div class="table-container">
                    <h3>Tabla 1.1. Contribución de cada delito al cambio 2024-2025</h3>
                    <p class="chart-subtitle">Análisis del peso relativo de cada delito en la variación total</p>
                    <div id="tabla-contribucion-cambio-idvfc"></div>
                </div>

                <div class="chart-container">
                    <h3>Gráfica 2. Cambios porcentuales anuales de la violencia homicida a nivel nacional</h3>
                    <p class="chart-subtitle">Variación porcentual año con año (2019-2025)</p>
                    <canvas id="chart-cambios-nacional-idvfc"></canvas>
                </div>

                <div class="table-container">
                    <h3>Tabla 2. Cambios porcentuales anuales a nivel nacional</h3>
                    <p class="chart-subtitle">Variación porcentual año con año por tipo de delito</p>
                    <div id="tabla-cambios-nacional-idvfc"></div>
                </div>

                <div class="chart-container">
                    <h3>Gráfica 3. Evolución mensual de la violencia homicida a nivel nacional (2024-2025)</h3>
                    <p class="chart-subtitle">Casos registrados por mes</p>
                    <canvas id="chart-violencia-mensual-idvfc"></canvas>
                </div>
                
                <div class="table-container">
                    <h3>Tabla 3. Violencia homicida mensual a nivel nacional (2024-2025)</h3>
                    <p class="chart-subtitle">Casos registrados por mes</p>
                    <div id="tabla-violencia-mensual-idvfc"></div>
                </div>

                <div class="chart-container">
                    <h3>Gráfica 4. Cambios porcentuales mensuales de la violencia homicida a nivel nacional (2024-2025)</h3>
                    <p class="chart-subtitle">Variación porcentual mes con mes</p>
                    <canvas id="chart-cambios-mensual-nacional-idvfc"></canvas>
                </div>

                <div class="table-container">
                    <h3>Tabla 4. Cambios porcentuales mensuales a nivel nacional (2024-2025)</h3>
                    <p class="chart-subtitle">Variación porcentual mes con mes por tipo de delito</p>
                    <div id="tabla-cambios-mensual-nacional-idvfc"></div>
                </div>

                <div class="chart-container">
                    <h3>Gráfica 5. Evolución de la violencia homicida a nivel nacional (2019-2025)</h3>
                    <p class="chart-subtitle">Tasa por cada 100,000 habitantes de enero a julio por año</p>
                    <canvas id="chart-violencia-homicida-rates-idvfc"></canvas>
                </div>

                <div class="table-container">
                    <h3>Tabla 5. Violencia homicida por tipo de delito (2019-2025)</h3>
                    <p class="chart-subtitle">Tasa por cada 100,000 habitantes de enero a julio por año</p>
                    <div id="tabla-violencia-homicida-rates-idvfc"></div>
                </div>

                <div class="table-container">
                    <h3>Tabla 6. Nivel de la violencia homicida a nivel estatal (2025)</h3>
                    <p class="chart-subtitle" id="tabla-estatal-idvfc-subtitle">Estados ordenados por mayor número de homicidios dolosos (enero-julio 2025)</p>
                    <div id="tabla-estatal-idvfc-2025"></div>
                </div>

                <div class="chart-container">
                    <h3>Gráfica 6. Composición de la violencia homicida por estado (2025)</h3>
                    <p class="chart-subtitle">Distribución por tipo de delito (enero-julio 2025)</p>
                    <canvas id="chart-estatal-stacked-idvfc"></canvas>
                </div>

                <div class="ranking-evolution-container">
                    <h3>Tabla 7. Evolución mensual del ranking estatal (Top 10)</h3>
                    <p class="chart-subtitle">Ranking de estados por tipo de violencia - 19 meses (Enero 2024 a Julio 2025)</p>
                    
                    <div class="ranking-controls">
                        <label for="violence-type-selector-idvfc">Tipo de violencia:</label>
                        <select id="violence-type-selector-idvfc">
                            <option value="Total">Violencia homicida total</option>
                            <option value="Homicidio doloso">Homicidio doloso</option>
                            <option value="Homicidio culposo">Homicidio culposo</option>
                            <option value="Feminicidio">Feminicidio</option>
                            <option value="Otros delitos que atentan contra la vida y la integridad corporal">Otros delitos contra la vida</option>
                        </select>
                    </div>

                    <div id="ranking-tables-grid-idvfc" class="ranking-grid">
                        <!-- Las tablas se generarán dinámicamente aquí -->
                    </div>
                </div>

                <div class="table-container">
                    <h3>Tabla 8. Tasas de violencia homicida a nivel estatal (2025)</h3>
                    <p class="chart-subtitle" id="tabla-estatal-rates-idvfc-subtitle">Estados ordenados por mayor tasa de violencia homicida total por 100,000 habitantes (enero-julio 2025)</p>
                    
                    <div id="tabla-estatal-rates-idvfc-2025"></div>
                </div>

                <!-- Gráfica 9. Evolución de la violencia homicida en Sinaloa (2019-2025) -->
                <div class="chart-container">
                    <h3>Gráfica 9. Evolución de la violencia homicida en Sinaloa (2019-2025)</h3>
                    <p class="chart-subtitle">Casos registrados de enero a julio por año</p>
                    <canvas id="chart-sinaloa-anual-idvfc"></canvas>
                </div>

                <!-- Tabla 11. Violencia homicida en Sinaloa por tipo de delito (2019-2025) -->
                <div class="table-container">
                    <h3>Tabla 11. Violencia homicida en Sinaloa por tipo de delito (2019-2025)</h3>
                    <p class="chart-subtitle">Casos registrados de enero a julio por año</p>
                    <div id="tabla-sinaloa-idvfc"></div>
                </div>

                <!-- Gráfica 10. Evolución mensual de la violencia homicida en Sinaloa (2024-2025) -->
                <div class="chart-container">
                    <h3>Gráfica 10. Evolución mensual de la violencia homicida en Sinaloa (2024-2025)</h3>
                    <p class="chart-subtitle">Casos registrados por mes</p>
                    
                    <div class="chart-controls">
                        <div class="control-group">
                            <label for="grafica-10-subtipo-selector-idvfc">Subtipo de delito:</label>
                            <select id="grafica-10-subtipo-selector-idvfc">
                                <option value="Homicidio doloso">Homicidio doloso</option>
                                <option value="Homicidio culposo">Homicidio culposo</option>
                                <option value="Feminicidio">Feminicidio</option>
                                <option value="Otros delitos que atentan contra la vida y la integridad corporal">Otros delitos contra la vida</option>
                                <option value="Total">Total violencia homicida</option>
                            </select>
                        </div>
                    </div>

                    <canvas id="chart-grafica-10-sinaloa-idvfc"></canvas>
                </div>

                <!-- Tabla 12. Evolución mensual de la violencia homicida en Sinaloa (2024-2025) -->
                <div class="table-container">
                    <h3>Tabla 12. Evolución mensual de la violencia homicida en Sinaloa (2024-2025)</h3>
                    <p class="chart-subtitle">Casos registrados por mes</p>
                    <div id="tabla-sinaloa-mensual-idvfc"></div>
                </div>

                <!-- Gráfica 13. Composición por edad de víctimas en Sinaloa (2024-2025) -->
                <div class="chart-container">
                    <h3>Gráfica 13. Composición por edad de víctimas en Sinaloa (2024-2025)</h3>
                    <p class="chart-subtitle">Distribución de víctimas por rango de edad según subtipo de delito</p>
                    
                    <div class="chart-controls">
                        <div class="control-group">
                            <label for="edad-subtipo-selector">Subtipo de delito:</label>
                            <select id="edad-subtipo-selector">
                                <option value="Homicidio doloso">Homicidio doloso</option>
                                <option value="Homicidio culposo">Homicidio culposo</option>
                                <option value="Feminicidio">Feminicidio</option>
                                <option value="Otros delitos que atentan contra la vida y la integridad corporal">Otros delitos contra la vida</option>
                            </select>
                        </div>
                    </div>

                    <canvas id="chart-sinaloa-edad-composicion"></canvas>
                </div>

                <!-- Tabla 13. Composición por edad de víctimas en Sinaloa (2024-2025) -->
                <div class="table-container">
                    <h3>Tabla 13. Composición por edad de víctimas en Sinaloa (2024-2025)</h3>
                    <p class="chart-subtitle">Casos registrados por rango de edad y mes</p>
                    <div id="tabla-sinaloa-edad-composicion"></div>
                </div>
            </section>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 - Análisis de Datos SESNSP México</p>
        </div>
    </footer>

    <!-- Scripts necesarios para la funcionalidad IDVFC -->
    <!-- <script src="scripts/spillover_enhanced.js?v=6"></script> -->
    <!-- <script src="scripts/main.js?v=30"></script> -->
    <!-- <script src="scripts/grafica_10_sinaloa.js?v=12"></script> -->
    <!-- <script src="scripts/heatmap_sinaloa.js?v=3"></script> -->
    <script src="scripts/sinaloa_edad_chart.js"></script>

    <script>
        // Datos IDVFC reales (copiados exactamente del index.html)
        const idvfcViolenciaHomicidaData = [
            {
                Delito: 'Homicidio doloso',
                '2019': 20226,
                '2020': 20551,
                '2021': 19834,
                '2022': 18061,
                '2023': 17612,
                '2024': 17668,
                '2025': 14769
            },
            {
                Delito: 'Homicidio culposo',
                '2019': 10278,
                '2020': 9384,
                '2021': 10368,
                '2022': 11182,
                '2023': 11486,
                '2024': 11417,
                '2025': 10821
            },
            {
                Delito: 'Feminicidio',
                '2019': 539,
                '2020': 564,
                '2021': 611,
                '2022': 584,
                '2023': 525,
                '2024': 507,
                '2025': 394
            },
            {
                Delito: 'Otros delitos que atentan contra la vida y la integridad corporal',
                '2019': 5508,
                '2020': 6790,
                '2021': 8722,
                '2022': 8855,
                '2023': 9624,
                '2024': 9772,
                '2025': 10024
            },
            {
                Delito: 'Total',
                '2019': 36551,
                '2020': 37289,
                '2021': 39535,
                '2022': 38682,
                '2023': 39247,
                '2024': 39364,
                '2025': 36008
            }
        ];

        // Datos de población nacional (copiados exactamente del index.html)
        const idvfcPoblacionNacional = {
            '2019': 125085215,
            '2020': 126705138,
            '2021': 128455567,
            '2022': 129875529,
            '2023': 129929800,
            '2024': 130047269,
            '2025': 133367428
        };

        // Función para calcular tasas por 100,000 habitantes
        function calculateIDVFCRate(casos, poblacion) {
            return poblacion > 0 ? (casos / poblacion) * 100000 : 0;
        }

        // Datos mensuales de violencia homicida nacional (enero 2024 - julio 2025)
        const idvfcViolenciaHomicidaMensualData = [
            {
                "Periodo": "Enero 2024",
                "Homicidio doloso": 2434,
                "Homicidio culposo": 1490,
                "Feminicidio": 65,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1236,
                "Total": 5225
            },
            {
                "Periodo": "Febrero 2024",
                "Homicidio doloso": 2315,
                "Homicidio culposo": 1490,
                "Feminicidio": 65,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1216,
                "Total": 5086
            },
            {
                "Periodo": "Marzo 2024",
                "Homicidio doloso": 2411,
                "Homicidio culposo": 1734,
                "Feminicidio": 78,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1424,
                "Total": 5647
            },
            {
                "Periodo": "Abril 2024",
                "Homicidio doloso": 2614,
                "Homicidio culposo": 1658,
                "Feminicidio": 64,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1392,
                "Total": 5728
            },
            {
                "Periodo": "Mayo 2024",
                "Homicidio doloso": 2652,
                "Homicidio culposo": 1887,
                "Feminicidio": 95,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1618,
                "Total": 6252
            },
            {
                "Periodo": "Junio 2024",
                "Homicidio doloso": 2678,
                "Homicidio culposo": 1616,
                "Feminicidio": 70,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1438,
                "Total": 5802
            },
            {
                "Periodo": "Julio 2024",
                "Homicidio doloso": 2564,
                "Homicidio culposo": 1542,
                "Feminicidio": 70,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1448,
                "Total": 5624
            },
            {
                "Periodo": "Agosto 2024",
                "Homicidio doloso": 2468,
                "Homicidio culposo": 1534,
                "Feminicidio": 66,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1459,
                "Total": 5527
            },
            {
                "Periodo": "Septiembre 2024",
                "Homicidio doloso": 2607,
                "Homicidio culposo": 1441,
                "Feminicidio": 78,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1377,
                "Total": 5503
            },
            {
                "Periodo": "Octubre 2024",
                "Homicidio doloso": 2571,
                "Homicidio culposo": 1553,
                "Feminicidio": 74,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1374,
                "Total": 5572
            },
            {
                "Periodo": "Noviembre 2024",
                "Homicidio doloso": 2462,
                "Homicidio culposo": 1604,
                "Feminicidio": 64,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1259,
                "Total": 5389
            },
            {
                "Periodo": "Diciembre 2024",
                "Homicidio doloso": 2271,
                "Homicidio culposo": 1737,
                "Feminicidio": 63,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1095,
                "Total": 5166
            },
            {
                "Periodo": "Enero 2025",
                "Homicidio doloso": 2389,
                "Homicidio culposo": 1499,
                "Feminicidio": 59,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1102,
                "Total": 5049
            },
            {
                "Periodo": "Febrero 2025",
                "Homicidio doloso": 2099,
                "Homicidio culposo": 1405,
                "Feminicidio": 45,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1273,
                "Total": 4822
            },
            {
                "Periodo": "Marzo 2025",
                "Homicidio doloso": 2322,
                "Homicidio culposo": 1720,
                "Feminicidio": 64,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1645,
                "Total": 5751
            },
            {
                "Periodo": "Abril 2025",
                "Homicidio doloso": 1973,
                "Homicidio culposo": 1652,
                "Feminicidio": 52,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1430,
                "Total": 5107
            },
            {
                "Periodo": "Mayo 2025",
                "Homicidio doloso": 2001,
                "Homicidio culposo": 1616,
                "Feminicidio": 61,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1613,
                "Total": 5291
            },
            {
                "Periodo": "Junio 2025",
                "Homicidio doloso": 1972,
                "Homicidio culposo": 1514,
                "Feminicidio": 59,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1474,
                "Total": 5019
            },
            {
                "Periodo": "Julio 2025",
                "Homicidio doloso": 2013,
                "Homicidio culposo": 1415,
                "Feminicidio": 54,
                "Otros delitos que atentan contra la vida y la integridad corporal": 1487,
                "Total": 4969
            }
        ];

        // Datos reales del CSV IDVFC_NM_jul25.csv - TODOS los 19 meses verificados (enero 2024 - julio 2025)
        const rankingMensualData = {
'Enero 2024': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:250}, {Estado:'México',Valor:222}, {Estado:'Baja California',Valor:198}, {Estado:'Chihuahua',Valor:189}, {Estado:'Michoacán de Ocampo',Valor:156}, {Estado:'Jalisco',Valor:154}, {Estado:'Sonora',Valor:148}, {Estado:'Guerrero',Valor:145}, {Estado:'Morelos',Valor:131}, {Estado:'Nuevo León',Valor:111}, ], 'Homicidio culposo': [{Estado:'México',Valor:132}, {Estado:'Guanajuato',Valor:127}, {Estado:'Michoacán de Ocampo',Valor:118}, {Estado:'Jalisco',Valor:100}, {Estado:'Oaxaca',Valor:89}, {Estado:'Ciudad de México',Valor:83}, {Estado:'Quintana Roo',Valor:82}, {Estado:'Veracruz de Ignacio de la Llave',Valor:81}, {Estado:'Chiapas',Valor:69}, {Estado:'Tamaulipas',Valor:67}, ], 'Feminicidio': [{Estado:'México',Valor:11}, {Estado:'Ciudad de México',Valor:8}, {Estado:'Veracruz de Ignacio de la Llave',Valor:8}, {Estado:'Nuevo León',Valor:6}, {Estado:'Chihuahua',Valor:5}, {Estado:'Sonora',Valor:4}, {Estado:'Campeche',Valor:2}, {Estado:'Chiapas',Valor:2}, {Estado:'Michoacán de Ocampo',Valor:2}, {Estado:'Morelos',Valor:2}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:225}, {Estado:'Guanajuato',Valor:132}, {Estado:'México',Valor:101}, {Estado:'Querétaro',Valor:98}, {Estado:'Ciudad de México',Valor:83}, {Estado:'Morelos',Valor:75}, {Estado:'Sinaloa',Valor:64}, {Estado:'Zacatecas',Valor:42}, {Estado:'Quintana Roo',Valor:35}, {Estado:'Sonora',Valor:35}, ], 'Total': [{Estado:'Guanajuato',Valor:510}, {Estado:'México',Valor:466}, {Estado:'Baja California',Valor:462}, {Estado:'Michoacán de Ocampo',Valor:309}, {Estado:'Jalisco',Valor:279}, {Estado:'Chihuahua',Valor:253}, {Estado:'Morelos',Valor:232}, {Estado:'Ciudad de México',Valor:231}, {Estado:'Sonora',Valor:216}, {Estado:'Guerrero',Valor:202}, ], }, 
'Febrero 2024': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:231}, {Estado:'Baja California',Valor:219}, {Estado:'México',Valor:196}, {Estado:'Chihuahua',Valor:157}, {Estado:'Guerrero',Valor:155}, {Estado:'Morelos',Valor:144}, {Estado:'Jalisco',Valor:143}, {Estado:'Michoacán de Ocampo',Valor:140}, {Estado:'Nuevo León',Valor:113}, {Estado:'Sonora',Valor:105}, ], 'Homicidio culposo': [{Estado:'México',Valor:126}, {Estado:'Oaxaca',Valor:117}, {Estado:'Michoacán de Ocampo',Valor:109}, {Estado:'Veracruz de Ignacio de la Llave',Valor:95}, {Estado:'Guanajuato',Valor:93}, {Estado:'Chiapas',Valor:80}, {Estado:'Quintana Roo',Valor:77}, {Estado:'Ciudad de México',Valor:76}, {Estado:'Jalisco',Valor:63}, {Estado:'Tamaulipas',Valor:58}, ], 'Feminicidio': [{Estado:'Ciudad de México',Valor:7}, {Estado:'México',Valor:7}, {Estado:'Morelos',Valor:5}, {Estado:'Sonora',Valor:5}, {Estado:'Baja California',Valor:4}, {Estado:'Guerrero',Valor:4}, {Estado:'Tabasco',Valor:4}, {Estado:'Puebla',Valor:3}, {Estado:'Sinaloa',Valor:3}, {Estado:'Tamaulipas',Valor:3}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:207}, {Estado:'México',Valor:143}, {Estado:'Guanajuato',Valor:125}, {Estado:'Ciudad de México',Valor:102}, {Estado:'Querétaro',Valor:74}, {Estado:'Morelos',Valor:68}, {Estado:'Sinaloa',Valor:52}, {Estado:'Zacatecas',Valor:40}, {Estado:'Chihuahua',Valor:38}, {Estado:'Sonora',Valor:38}, ], 'Total': [{Estado:'Baja California',Valor:477}, {Estado:'México',Valor:472}, {Estado:'Guanajuato',Valor:449}, {Estado:'Michoacán de Ocampo',Valor:284}, {Estado:'Ciudad de México',Valor:263}, {Estado:'Morelos',Valor:246}, {Estado:'Jalisco',Valor:234}, {Estado:'Chihuahua',Valor:212}, {Estado:'Guerrero',Valor:202}, {Estado:'Oaxaca',Valor:200}, ], }, 
'Marzo 2024': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:261}, {Estado:'México',Valor:208}, {Estado:'Baja California',Valor:181}, {Estado:'Jalisco',Valor:162}, {Estado:'Chihuahua',Valor:148}, {Estado:'Michoacán de Ocampo',Valor:144}, {Estado:'Morelos',Valor:142}, {Estado:'Guerrero',Valor:108}, {Estado:'Sonora',Valor:108}, {Estado:'Nuevo León',Valor:95}, ], 'Homicidio culposo': [{Estado:'México',Valor:152}, {Estado:'Oaxaca',Valor:147}, {Estado:'Guanajuato',Valor:121}, {Estado:'Michoacán de Ocampo',Valor:119}, {Estado:'Veracruz de Ignacio de la Llave',Valor:102}, {Estado:'Jalisco',Valor:98}, {Estado:'Quintana Roo',Valor:94}, {Estado:'Puebla',Valor:92}, {Estado:'Chiapas',Valor:82}, {Estado:'Sinaloa',Valor:80}, ], 'Feminicidio': [{Estado:'Nuevo León',Valor:8}, {Estado:'México',Valor:6}, {Estado:'Chihuahua',Valor:5}, {Estado:'Ciudad de México',Valor:5}, {Estado:'Michoacán de Ocampo',Valor:5}, {Estado:'Morelos',Valor:5}, {Estado:'Puebla',Valor:5}, {Estado:'Chiapas',Valor:4}, {Estado:'Guanajuato',Valor:4}, {Estado:'Guerrero',Valor:4}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:258}, {Estado:'Guanajuato',Valor:236}, {Estado:'México',Valor:137}, {Estado:'Ciudad de México',Valor:98}, {Estado:'Querétaro',Valor:79}, {Estado:'Morelos',Valor:69}, {Estado:'Sinaloa',Valor:58}, {Estado:'Sonora',Valor:52}, {Estado:'Tabasco',Valor:42}, {Estado:'Nuevo León',Valor:41}, ], 'Total': [{Estado:'Guanajuato',Valor:622}, {Estado:'México',Valor:503}, {Estado:'Baja California',Valor:487}, {Estado:'Michoacán de Ocampo',Valor:304}, {Estado:'Jalisco',Valor:278}, {Estado:'Ciudad de México',Valor:258}, {Estado:'Oaxaca',Valor:244}, {Estado:'Morelos',Valor:238}, {Estado:'Veracruz de Ignacio de la Llave',Valor:223}, {Estado:'Chihuahua',Valor:209}, ], }, 
'Abril 2024': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:260}, {Estado:'Baja California',Valor:224}, {Estado:'México',Valor:187}, {Estado:'Morelos',Valor:179}, {Estado:'Chihuahua',Valor:159}, {Estado:'Michoacán de Ocampo',Valor:149}, {Estado:'Jalisco',Valor:142}, {Estado:'Guerrero',Valor:129}, {Estado:'Tabasco',Valor:125}, {Estado:'Nuevo León',Valor:123}, ], 'Homicidio culposo': [{Estado:'México',Valor:177}, {Estado:'Oaxaca',Valor:146}, {Estado:'Michoacán de Ocampo',Valor:118}, {Estado:'Puebla',Valor:118}, {Estado:'Guanajuato',Valor:104}, {Estado:'Jalisco',Valor:99}, {Estado:'Quintana Roo',Valor:83}, {Estado:'Veracruz de Ignacio de la Llave',Valor:78}, {Estado:'Chiapas',Valor:69}, {Estado:'Ciudad de México',Valor:65}, ], 'Feminicidio': [{Estado:'Nuevo León',Valor:8}, {Estado:'Chihuahua',Valor:7}, {Estado:'Morelos',Valor:6}, {Estado:'Baja California',Valor:4}, {Estado:'Veracruz de Ignacio de la Llave',Valor:4}, {Estado:'Ciudad de México',Valor:3}, {Estado:'Jalisco',Valor:3}, {Estado:'Puebla',Valor:3}, {Estado:'Guanajuato',Valor:2}, {Estado:'Hidalgo',Valor:2}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:247}, {Estado:'Guanajuato',Valor:175}, {Estado:'México',Valor:133}, {Estado:'Querétaro',Valor:82}, {Estado:'Morelos',Valor:70}, {Estado:'Ciudad de México',Valor:66}, {Estado:'Nuevo León',Valor:58}, {Estado:'Sinaloa',Valor:58}, {Estado:'Chihuahua',Valor:50}, {Estado:'Tabasco',Valor:47}, ], 'Total': [{Estado:'Guanajuato',Valor:541}, {Estado:'México',Valor:499}, {Estado:'Baja California',Valor:496}, {Estado:'Michoacán de Ocampo',Valor:301}, {Estado:'Morelos',Valor:278}, {Estado:'Jalisco',Valor:265}, {Estado:'Oaxaca',Valor:253}, {Estado:'Puebla',Valor:236}, {Estado:'Chihuahua',Valor:233}, {Estado:'Nuevo León',Valor:232}, ], }, 
'Mayo 2024': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:215}, {Estado:'Baja California',Valor:213}, {Estado:'México',Valor:200}, {Estado:'Chihuahua',Valor:193}, {Estado:'Nuevo León',Valor:169}, {Estado:'Jalisco',Valor:148}, {Estado:'Michoacán de Ocampo',Valor:140}, {Estado:'Guerrero',Valor:137}, {Estado:'Morelos',Valor:134}, {Estado:'Sonora',Valor:121}, ], 'Homicidio culposo': [{Estado:'México',Valor:192}, {Estado:'Oaxaca',Valor:157}, {Estado:'Guanajuato',Valor:153}, {Estado:'Puebla',Valor:111}, {Estado:'Veracruz de Ignacio de la Llave',Valor:107}, {Estado:'Michoacán de Ocampo',Valor:106}, {Estado:'Quintana Roo',Valor:103}, {Estado:'Jalisco',Valor:87}, {Estado:'Tabasco',Valor:79}, {Estado:'Ciudad de México',Valor:76}, ], 'Feminicidio': [{Estado:'Veracruz de Ignacio de la Llave',Valor:10}, {Estado:'Nuevo León',Valor:9}, {Estado:'Puebla',Valor:7}, {Estado:'Chiapas',Valor:6}, {Estado:'Jalisco',Valor:6}, {Estado:'Morelos',Valor:6}, {Estado:'Baja California',Valor:5}, {Estado:'Ciudad de México',Valor:4}, {Estado:'San Luis Potosï¿½',Valor:4}, {Estado:'Sonora',Valor:4}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:305}, {Estado:'Guanajuato',Valor:226}, {Estado:'México',Valor:163}, {Estado:'Querétaro',Valor:117}, {Estado:'Ciudad de México',Valor:84}, {Estado:'Sinaloa',Valor:77}, {Estado:'Morelos',Valor:55}, {Estado:'Tabasco',Valor:53}, {Estado:'Sonora',Valor:51}, {Estado:'Chihuahua',Valor:43}, ], 'Total': [{Estado:'Guanajuato',Valor:597}, {Estado:'Baja California',Valor:565}, {Estado:'México',Valor:558}, {Estado:'Michoacán de Ocampo',Valor:288}, {Estado:'Nuevo León',Valor:279}, {Estado:'Chihuahua',Valor:261}, {Estado:'Oaxaca',Valor:261}, {Estado:'Jalisco',Valor:259}, {Estado:'Ciudad de México',Valor:258}, {Estado:'Puebla',Valor:242}, ], }, 
'Junio 2024': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:252}, {Estado:'México',Valor:195}, {Estado:'Chihuahua',Valor:193}, {Estado:'Baja California',Valor:192}, {Estado:'Jalisco',Valor:180}, {Estado:'Guerrero',Valor:170}, {Estado:'Nuevo León',Valor:170}, {Estado:'Sonora',Valor:153}, {Estado:'Morelos',Valor:131}, {Estado:'Michoacán de Ocampo',Valor:130}, ], 'Homicidio culposo': [{Estado:'México',Valor:131}, {Estado:'Oaxaca',Valor:129}, {Estado:'Michoacán de Ocampo',Valor:119}, {Estado:'Guanajuato',Valor:114}, {Estado:'Puebla',Valor:109}, {Estado:'Jalisco',Valor:94}, {Estado:'Chiapas',Valor:90}, {Estado:'Ciudad de México',Valor:79}, {Estado:'Veracruz de Ignacio de la Llave',Valor:78}, {Estado:'Quintana Roo',Valor:75}, ], 'Feminicidio': [{Estado:'Ciudad de México',Valor:9}, {Estado:'México',Valor:6}, {Estado:'Morelos',Valor:6}, {Estado:'Nuevo León',Valor:5}, {Estado:'Puebla',Valor:5}, {Estado:'Chihuahua',Valor:4}, {Estado:'Tabasco',Valor:4}, {Estado:'Tamaulipas',Valor:4}, {Estado:'Baja California',Valor:3}, {Estado:'Coahuila de Zaragoza',Valor:3}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:240}, {Estado:'Guanajuato',Valor:183}, {Estado:'México',Valor:155}, {Estado:'Querétaro',Valor:93}, {Estado:'Ciudad de México',Valor:70}, {Estado:'Morelos',Valor:69}, {Estado:'Sinaloa',Valor:66}, {Estado:'Sonora',Valor:63}, {Estado:'Tabasco',Valor:54}, {Estado:'Chihuahua',Valor:50}, ], 'Total': [{Estado:'Guanajuato',Valor:551}, {Estado:'México',Valor:487}, {Estado:'Baja California',Valor:479}, {Estado:'Jalisco',Valor:283}, {Estado:'Michoacán de Ocampo',Valor:273}, {Estado:'Chihuahua',Valor:271}, {Estado:'Nuevo León',Valor:246}, {Estado:'Oaxaca',Valor:242}, {Estado:'Sonora',Valor:242}, {Estado:'Morelos',Valor:230}, ], }, 
'Julio 2024': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:256}, {Estado:'Baja California',Valor:202}, {Estado:'Jalisco',Valor:191}, {Estado:'México',Valor:176}, {Estado:'Chihuahua',Valor:169}, {Estado:'Guerrero',Valor:159}, {Estado:'Nuevo León',Valor:155}, {Estado:'Sonora',Valor:147}, {Estado:'Michoacán de Ocampo',Valor:116}, {Estado:'Morelos',Valor:108}, ], 'Homicidio culposo': [{Estado:'México',Valor:140}, {Estado:'Oaxaca',Valor:137}, {Estado:'Guanajuato',Valor:109}, {Estado:'Michoacán de Ocampo',Valor:100}, {Estado:'Quintana Roo',Valor:87}, {Estado:'Puebla',Valor:82}, {Estado:'Veracruz de Ignacio de la Llave',Valor:74}, {Estado:'Jalisco',Valor:70}, {Estado:'Nuevo León',Valor:62}, {Estado:'Ciudad de México',Valor:61}, ], 'Feminicidio': [{Estado:'Morelos',Valor:8}, {Estado:'Baja California',Valor:6}, {Estado:'Ciudad de México',Valor:6}, {Estado:'Nuevo León',Valor:6}, {Estado:'Puebla',Valor:6}, {Estado:'México',Valor:5}, {Estado:'Chihuahua',Valor:4}, {Estado:'Jalisco',Valor:4}, {Estado:'Sinaloa',Valor:4}, {Estado:'Veracruz de Ignacio de la Llave',Valor:4}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:254}, {Estado:'Guanajuato',Valor:170}, {Estado:'México',Valor:143}, {Estado:'Ciudad de México',Valor:104}, {Estado:'Querétaro',Valor:93}, {Estado:'Sonora',Valor:76}, {Estado:'Sinaloa',Valor:73}, {Estado:'Morelos',Valor:61}, {Estado:'Chihuahua',Valor:58}, {Estado:'Tabasco',Valor:57}, ], 'Total': [{Estado:'Guanajuato',Valor:535}, {Estado:'Baja California',Valor:507}, {Estado:'México',Valor:464}, {Estado:'Jalisco',Valor:279}, {Estado:'Chihuahua',Valor:261}, {Estado:'Michoacán de Ocampo',Valor:257}, {Estado:'Sonora',Valor:255}, {Estado:'Nuevo León',Valor:245}, {Estado:'Oaxaca',Valor:244}, {Estado:'Ciudad de México',Valor:238}, ], }, 
'Agosto 2024': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:269}, {Estado:'Baja California',Valor:209}, {Estado:'Guerrero',Valor:181}, {Estado:'México',Valor:175}, {Estado:'Nuevo León',Valor:162}, {Estado:'Jalisco',Valor:155}, {Estado:'Chihuahua',Valor:149}, {Estado:'Michoacán de Ocampo',Valor:109}, {Estado:'Sonora',Valor:106}, {Estado:'Morelos',Valor:104}, ], 'Homicidio culposo': [{Estado:'Oaxaca',Valor:114}, {Estado:'México',Valor:112}, {Estado:'Guanajuato',Valor:106}, {Estado:'Puebla',Valor:105}, {Estado:'Veracruz de Ignacio de la Llave',Valor:93}, {Estado:'Michoacán de Ocampo',Valor:92}, {Estado:'Quintana Roo',Valor:77}, {Estado:'Jalisco',Valor:75}, {Estado:'Tamaulipas',Valor:75}, {Estado:'Chiapas',Valor:68}, ], 'Feminicidio': [{Estado:'Michoacán de Ocampo',Valor:8}, {Estado:'Ciudad de México',Valor:7}, {Estado:'Veracruz de Ignacio de la Llave',Valor:6}, {Estado:'México',Valor:5}, {Estado:'Baja California',Valor:4}, {Estado:'Morelos',Valor:4}, {Estado:'Chihuahua',Valor:3}, {Estado:'Jalisco',Valor:3}, {Estado:'Nayarit',Valor:3}, {Estado:'Nuevo León',Valor:3}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:296}, {Estado:'Guanajuato',Valor:173}, {Estado:'México',Valor:143}, {Estado:'Ciudad de México',Valor:108}, {Estado:'Querétaro',Valor:97}, {Estado:'Chihuahua',Valor:70}, {Estado:'Sinaloa',Valor:70}, {Estado:'Sonora',Valor:59}, {Estado:'Quintana Roo',Valor:49}, {Estado:'Michoacán de Ocampo',Valor:42}, ], 'Total': [{Estado:'Baja California',Valor:552}, {Estado:'Guanajuato',Valor:549}, {Estado:'México',Valor:435}, {Estado:'Chihuahua',Valor:267}, {Estado:'Nuevo León',Valor:259}, {Estado:'Michoacán de Ocampo',Valor:251}, {Estado:'Ciudad de México',Valor:245}, {Estado:'Jalisco',Valor:241}, {Estado:'Oaxaca',Valor:230}, {Estado:'Guerrero',Valor:217}, ], }, 
'Septiembre 2024': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:283}, {Estado:'Baja California',Valor:214}, {Estado:'México',Valor:199}, {Estado:'Chihuahua',Valor:181}, {Estado:'Nuevo León',Valor:150}, {Estado:'Jalisco',Valor:144}, {Estado:'Sinaloa',Valor:143}, {Estado:'Sonora',Valor:123}, {Estado:'Puebla',Valor:119}, {Estado:'Guerrero',Valor:116}, ], 'Homicidio culposo': [{Estado:'México',Valor:137}, {Estado:'Oaxaca',Valor:111}, {Estado:'Puebla',Valor:97}, {Estado:'Michoacán de Ocampo',Valor:90}, {Estado:'Veracruz de Ignacio de la Llave',Valor:87}, {Estado:'Guanajuato',Valor:82}, {Estado:'Jalisco',Valor:74}, {Estado:'Ciudad de México',Valor:69}, {Estado:'Quintana Roo',Valor:69}, {Estado:'Tamaulipas',Valor:68}, ], 'Feminicidio': [{Estado:'México',Valor:9}, {Estado:'Chihuahua',Valor:8}, {Estado:'Puebla',Valor:8}, {Estado:'Ciudad de México',Valor:5}, {Estado:'Jalisco',Valor:5}, {Estado:'Veracruz de Ignacio de la Llave',Valor:4}, {Estado:'Baja California',Valor:3}, {Estado:'Chiapas',Valor:3}, {Estado:'Hidalgo',Valor:3}, {Estado:'Nuevo León',Valor:3}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:274}, {Estado:'México',Valor:161}, {Estado:'Guanajuato',Valor:148}, {Estado:'Ciudad de México',Valor:104}, {Estado:'Querétaro',Valor:87}, {Estado:'Sonora',Valor:74}, {Estado:'Sinaloa',Valor:59}, {Estado:'Morelos',Valor:50}, {Estado:'Chihuahua',Valor:42}, {Estado:'Michoacán de Ocampo',Valor:41}, ], 'Total': [{Estado:'Baja California',Valor:532}, {Estado:'Guanajuato',Valor:513}, {Estado:'México',Valor:506}, {Estado:'Chihuahua',Valor:265}, {Estado:'Ciudad de México',Valor:257}, {Estado:'Oaxaca',Valor:255}, {Estado:'Puebla',Valor:247}, {Estado:'Sinaloa',Valor:244}, {Estado:'Nuevo León',Valor:239}, {Estado:'Jalisco',Valor:236}, ], }, 
'Octubre 2024': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:320}, {Estado:'Guerrero',Valor:204}, {Estado:'Baja California',Valor:184}, {Estado:'Sinaloa',Valor:182}, {Estado:'México',Valor:178}, {Estado:'Chihuahua',Valor:165}, {Estado:'Nuevo León',Valor:120}, {Estado:'Jalisco',Valor:116}, {Estado:'Morelos',Valor:115}, {Estado:'Sonora',Valor:105}, ], 'Homicidio culposo': [{Estado:'Michoacán de Ocampo',Valor:130}, {Estado:'México',Valor:111}, {Estado:'Guanajuato',Valor:110}, {Estado:'Oaxaca',Valor:101}, {Estado:'Jalisco',Valor:99}, {Estado:'Puebla',Valor:99}, {Estado:'Veracruz de Ignacio de la Llave',Valor:79}, {Estado:'Quintana Roo',Valor:78}, {Estado:'Ciudad de México',Valor:66}, {Estado:'Zacatecas',Valor:63}, ], 'Feminicidio': [{Estado:'México',Valor:8}, {Estado:'Ciudad de México',Valor:7}, {Estado:'Sinaloa',Valor:6}, {Estado:'Morelos',Valor:5}, {Estado:'Nuevo León',Valor:5}, {Estado:'Tamaulipas',Valor:5}, {Estado:'Veracruz de Ignacio de la Llave',Valor:5}, {Estado:'Baja California',Valor:3}, {Estado:'Chihuahua',Valor:3}, {Estado:'Oaxaca',Valor:3}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:271}, {Estado:'México',Valor:152}, {Estado:'Guanajuato',Valor:151}, {Estado:'Ciudad de México',Valor:114}, {Estado:'Querétaro',Valor:85}, {Estado:'Sinaloa',Valor:81}, {Estado:'Chihuahua',Valor:65}, {Estado:'Sonora',Valor:56}, {Estado:'Morelos',Valor:44}, {Estado:'Tamaulipas',Valor:40}, ], 'Total': [{Estado:'Guanajuato',Valor:583}, {Estado:'Baja California',Valor:496}, {Estado:'México',Valor:449}, {Estado:'Sinaloa',Valor:320}, {Estado:'Ciudad de México',Valor:261}, {Estado:'Chihuahua',Valor:260}, {Estado:'Michoacán de Ocampo',Valor:258}, {Estado:'Guerrero',Valor:234}, {Estado:'Jalisco',Valor:226}, {Estado:'Nuevo León',Valor:220}, ], }, 
'Noviembre 2024': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:250}, {Estado:'Sinaloa',Valor:174}, {Estado:'Chihuahua',Valor:167}, {Estado:'México',Valor:162}, {Estado:'Baja California',Valor:160}, {Estado:'Guerrero',Valor:132}, {Estado:'Jalisco',Valor:128}, {Estado:'Morelos',Valor:128}, {Estado:'Sonora',Valor:116}, {Estado:'Tabasco',Valor:106}, ], 'Homicidio culposo': [{Estado:'México',Valor:156}, {Estado:'Michoacán de Ocampo',Valor:152}, {Estado:'Guanajuato',Valor:96}, {Estado:'Oaxaca',Valor:96}, {Estado:'Veracruz de Ignacio de la Llave',Valor:96}, {Estado:'Jalisco',Valor:91}, {Estado:'Puebla',Valor:84}, {Estado:'Quintana Roo',Valor:78}, {Estado:'Ciudad de México',Valor:76}, {Estado:'Chiapas',Valor:64}, ], 'Feminicidio': [{Estado:'Chiapas',Valor:7}, {Estado:'México',Valor:7}, {Estado:'Ciudad de México',Valor:5}, {Estado:'Tamaulipas',Valor:5}, {Estado:'Nuevo León',Valor:4}, {Estado:'Tabasco',Valor:4}, {Estado:'Veracruz de Ignacio de la Llave',Valor:4}, {Estado:'Oaxaca',Valor:3}, {Estado:'Coahuila de Zaragoza',Valor:2}, {Estado:'Chihuahua',Valor:2}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:227}, {Estado:'México',Valor:131}, {Estado:'Guanajuato',Valor:123}, {Estado:'Ciudad de México',Valor:103}, {Estado:'Querétaro',Valor:96}, {Estado:'Sonora',Valor:58}, {Estado:'Chihuahua',Valor:54}, {Estado:'Sinaloa',Valor:54}, {Estado:'Tabasco',Valor:43}, {Estado:'Tamaulipas',Valor:39}, ], 'Total': [{Estado:'Guanajuato',Valor:469}, {Estado:'México',Valor:456}, {Estado:'Baja California',Valor:427}, {Estado:'Michoacán de Ocampo',Valor:270}, {Estado:'Ciudad de México',Valor:269}, {Estado:'Sinaloa',Valor:264}, {Estado:'Chihuahua',Valor:256}, {Estado:'Jalisco',Valor:233}, {Estado:'Oaxaca',Valor:214}, {Estado:'Sonora',Valor:207}, ], }, 
'Diciembre 2024': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:304}, {Estado:'Baja California',Valor:173}, {Estado:'México',Valor:160}, {Estado:'Sinaloa',Valor:157}, {Estado:'Chihuahua',Valor:155}, {Estado:'Jalisco',Valor:137}, {Estado:'Michoacán de Ocampo',Valor:118}, {Estado:'Guerrero',Valor:102}, {Estado:'Morelos',Valor:98}, {Estado:'Puebla',Valor:87}, ], 'Homicidio culposo': [{Estado:'Michoacán de Ocampo',Valor:149}, {Estado:'Guanajuato',Valor:148}, {Estado:'México',Valor:136}, {Estado:'Veracruz de Ignacio de la Llave',Valor:102}, {Estado:'Oaxaca',Valor:101}, {Estado:'Jalisco',Valor:99}, {Estado:'Puebla',Valor:97}, {Estado:'Quintana Roo',Valor:90}, {Estado:'Ciudad de México',Valor:88}, {Estado:'Chiapas',Valor:74}, ], 'Feminicidio': [{Estado:'México',Valor:7}, {Estado:'Chiapas',Valor:5}, {Estado:'Ciudad de México',Valor:5}, {Estado:'Sinaloa',Valor:5}, {Estado:'Chihuahua',Valor:4}, {Estado:'Tabasco',Valor:4}, {Estado:'Baja California',Valor:3}, {Estado:'Hidalgo',Valor:3}, {Estado:'Jalisco',Valor:3}, {Estado:'Quintana Roo',Valor:3}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:214}, {Estado:'México',Valor:128}, {Estado:'Ciudad de México',Valor:90}, {Estado:'Guanajuato',Valor:89}, {Estado:'Querétaro',Valor:79}, {Estado:'Sinaloa',Valor:69}, {Estado:'Sonora',Valor:54}, {Estado:'Chihuahua',Valor:36}, {Estado:'Morelos',Valor:36}, {Estado:'Nuevo León',Valor:29}, ], 'Total': [{Estado:'Guanajuato',Valor:542}, {Estado:'México',Valor:431}, {Estado:'Baja California',Valor:426}, {Estado:'Michoacán de Ocampo',Valor:286}, {Estado:'Sinaloa',Valor:274}, {Estado:'Ciudad de México',Valor:259}, {Estado:'Jalisco',Valor:257}, {Estado:'Chihuahua',Valor:241}, {Estado:'Puebla',Valor:202}, {Estado:'Oaxaca',Valor:181}, ], }, 
'Enero 2025': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:366}, {Estado:'Baja California',Valor:187}, {Estado:'México',Valor:155}, {Estado:'Chihuahua',Valor:153}, {Estado:'Sinaloa',Valor:147}, {Estado:'Michoacán de Ocampo',Valor:134}, {Estado:'Jalisco',Valor:124}, {Estado:'Guerrero',Valor:122}, {Estado:'Sonora',Valor:120}, {Estado:'Morelos',Valor:108}, ], 'Homicidio culposo': [{Estado:'Guanajuato',Valor:129}, {Estado:'Michoacán de Ocampo',Valor:127}, {Estado:'Oaxaca',Valor:113}, {Estado:'México',Valor:112}, {Estado:'Chiapas',Valor:92}, {Estado:'Veracruz de Ignacio de la Llave',Valor:90}, {Estado:'Jalisco',Valor:85}, {Estado:'Puebla',Valor:79}, {Estado:'Tamaulipas',Valor:69}, {Estado:'Quintana Roo',Valor:60}, ], 'Feminicidio': [{Estado:'México',Valor:7}, {Estado:'Baja California',Valor:6}, {Estado:'Puebla',Valor:5}, {Estado:'Morelos',Valor:4}, {Estado:'Tamaulipas',Valor:4}, {Estado:'Chihuahua',Valor:3}, {Estado:'Ciudad de México',Valor:3}, {Estado:'Hidalgo',Valor:3}, {Estado:'Michoacán de Ocampo',Valor:3}, {Estado:'Querétaro',Valor:3}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:199}, {Estado:'México',Valor:107}, {Estado:'Querétaro',Valor:93}, {Estado:'Guanajuato',Valor:74}, {Estado:'Ciudad de México',Valor:73}, {Estado:'Sonora',Valor:65}, {Estado:'Chihuahua',Valor:50}, {Estado:'Sinaloa',Valor:50}, {Estado:'Morelos',Valor:36}, {Estado:'Zacatecas',Valor:36}, ], 'Total': [{Estado:'Guanajuato',Valor:569}, {Estado:'Baja California',Valor:427}, {Estado:'México',Valor:381}, {Estado:'Michoacán de Ocampo',Valor:292}, {Estado:'Sinaloa',Valor:244}, {Estado:'Chihuahua',Valor:226}, {Estado:'Jalisco',Valor:218}, {Estado:'Morelos',Valor:206}, {Estado:'Oaxaca',Valor:206}, {Estado:'Sonora',Valor:206}, ], }, 
'Febrero 2025': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:356}, {Estado:'Baja California',Valor:153}, {Estado:'México',Valor:142}, {Estado:'Chihuahua',Valor:124}, {Estado:'Sinaloa',Valor:120}, {Estado:'Michoacán de Ocampo',Valor:114}, {Estado:'Sonora',Valor:111}, {Estado:'Jalisco',Valor:100}, {Estado:'Guerrero',Valor:92}, {Estado:'Tabasco',Valor:90}, ], 'Homicidio culposo': [{Estado:'Guanajuato',Valor:132}, {Estado:'México',Valor:109}, {Estado:'Oaxaca',Valor:106}, {Estado:'Michoacán de Ocampo',Valor:104}, {Estado:'Veracruz de Ignacio de la Llave',Valor:85}, {Estado:'Puebla',Valor:83}, {Estado:'Jalisco',Valor:77}, {Estado:'Quintana Roo',Valor:64}, {Estado:'Chiapas',Valor:58}, {Estado:'Sinaloa',Valor:57}, ], 'Feminicidio': [{Estado:'Sinaloa',Valor:5}, {Estado:'Guanajuato',Valor:4}, {Estado:'México',Valor:4}, {Estado:'Ciudad de México',Valor:3}, {Estado:'Quintana Roo',Valor:3}, {Estado:'Campeche',Valor:2}, {Estado:'Colima',Valor:2}, {Estado:'Chihuahua',Valor:2}, {Estado:'Hidalgo',Valor:2}, {Estado:'Michoacán de Ocampo',Valor:2}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:232}, {Estado:'Ciudad de México',Valor:130}, {Estado:'México',Valor:126}, {Estado:'Querétaro',Valor:88}, {Estado:'Chihuahua',Valor:79}, {Estado:'Sonora',Valor:77}, {Estado:'Sinaloa',Valor:70}, {Estado:'Tabasco',Valor:62}, {Estado:'Morelos',Valor:41}, {Estado:'Quintana Roo',Valor:38}, ], 'Total': [{Estado:'Guanajuato',Valor:528}, {Estado:'Baja California',Valor:425}, {Estado:'México',Valor:381}, {Estado:'Ciudad de México',Valor:270}, {Estado:'Sinaloa',Valor:252}, {Estado:'Michoacán de Ocampo',Valor:248}, {Estado:'Chihuahua',Valor:223}, {Estado:'Sonora',Valor:203}, {Estado:'Jalisco',Valor:198}, {Estado:'Tabasco',Valor:189}, ], }, 
'Marzo 2025': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:343}, {Estado:'Chihuahua',Valor:183}, {Estado:'México',Valor:166}, {Estado:'Baja California',Valor:151}, {Estado:'Jalisco',Valor:143}, {Estado:'Sinaloa',Valor:135}, {Estado:'Sonora',Valor:125}, {Estado:'Michoacán de Ocampo',Valor:111}, {Estado:'Guerrero',Valor:110}, {Estado:'Morelos',Valor:95}, ], 'Homicidio culposo': [{Estado:'Oaxaca',Valor:169}, {Estado:'México',Valor:141}, {Estado:'Guanajuato',Valor:124}, {Estado:'Michoacán de Ocampo',Valor:121}, {Estado:'Quintana Roo',Valor:97}, {Estado:'Jalisco',Valor:96}, {Estado:'Veracruz de Ignacio de la Llave',Valor:94}, {Estado:'Puebla',Valor:92}, {Estado:'Chiapas',Valor:69}, {Estado:'Ciudad de México',Valor:66}, ], 'Feminicidio': [{Estado:'México',Valor:7}, {Estado:'Nayarit',Valor:6}, {Estado:'Jalisco',Valor:5}, {Estado:'Chiapas',Valor:4}, {Estado:'Guerrero',Valor:4}, {Estado:'Baja California',Valor:3}, {Estado:'Chihuahua',Valor:3}, {Estado:'Nuevo León',Valor:3}, {Estado:'Tabasco',Valor:3}, {Estado:'Ciudad de México',Valor:2}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Chihuahua',Valor:263}, {Estado:'Baja California',Valor:257}, {Estado:'México',Valor:187}, {Estado:'Ciudad de México',Valor:115}, {Estado:'Tabasco',Valor:106}, {Estado:'Querétaro',Valor:86}, {Estado:'Sinaloa',Valor:83}, {Estado:'Guanajuato',Valor:78}, {Estado:'Sonora',Valor:74}, {Estado:'Morelos',Valor:63}, ], 'Total': [{Estado:'Guanajuato',Valor:547}, {Estado:'México',Valor:501}, {Estado:'Chihuahua',Valor:479}, {Estado:'Baja California',Valor:447}, {Estado:'Michoacán de Ocampo',Valor:271}, {Estado:'Sinaloa',Valor:269}, {Estado:'Ciudad de México',Valor:266}, {Estado:'Oaxaca',Valor:260}, {Estado:'Jalisco',Valor:252}, {Estado:'Tabasco',Valor:224}, ], }, 
'Abril 2025': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:195}, {Estado:'Guerrero',Valor:169}, {Estado:'México',Valor:138}, {Estado:'Chihuahua',Valor:134}, {Estado:'Jalisco',Valor:133}, {Estado:'Baja California',Valor:124}, {Estado:'Sinaloa',Valor:119}, {Estado:'Michoacán de Ocampo',Valor:107}, {Estado:'Nuevo León',Valor:91}, {Estado:'Morelos',Valor:90}, ], 'Homicidio culposo': [{Estado:'Oaxaca',Valor:137}, {Estado:'México',Valor:133}, {Estado:'Guanajuato',Valor:118}, {Estado:'Michoacán de Ocampo',Valor:117}, {Estado:'Jalisco',Valor:102}, {Estado:'Puebla',Valor:101}, {Estado:'Quintana Roo',Valor:93}, {Estado:'Chiapas',Valor:87}, {Estado:'Veracruz de Ignacio de la Llave',Valor:72}, {Estado:'Ciudad de México',Valor:63}, ], 'Feminicidio': [{Estado:'México',Valor:6}, {Estado:'Sinaloa',Valor:6}, {Estado:'Chiapas',Valor:5}, {Estado:'Morelos',Valor:5}, {Estado:'Ciudad de México',Valor:4}, {Estado:'Chihuahua',Valor:3}, {Estado:'Oaxaca',Valor:3}, {Estado:'Veracruz de Ignacio de la Llave',Valor:3}, {Estado:'Hidalgo',Valor:2}, {Estado:'Michoacán de Ocampo',Valor:2}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:228}, {Estado:'México',Valor:140}, {Estado:'Guanajuato',Valor:121}, {Estado:'Chihuahua',Valor:110}, {Estado:'Querétaro',Valor:101}, {Estado:'Ciudad de México',Valor:97}, {Estado:'Tabasco',Valor:86}, {Estado:'Sinaloa',Valor:76}, {Estado:'Morelos',Valor:63}, {Estado:'Sonora',Valor:61}, ], 'Total': [{Estado:'Guanajuato',Valor:434}, {Estado:'México',Valor:417}, {Estado:'Baja California',Valor:388}, {Estado:'Chihuahua',Valor:282}, {Estado:'Michoacán de Ocampo',Valor:269}, {Estado:'Sinaloa',Valor:255}, {Estado:'Jalisco',Valor:246}, {Estado:'Ciudad de México',Valor:244}, {Estado:'Oaxaca',Valor:228}, {Estado:'Guerrero',Valor:212}, ], }, 
'Mayo 2025': {'Homicidio doloso': [{Estado:'Guanajuato',Valor:175}, {Estado:'Sinaloa',Valor:165}, {Estado:'Baja California',Valor:133}, {Estado:'Chihuahua',Valor:133}, {Estado:'Guerrero',Valor:133}, {Estado:'Michoacán de Ocampo',Valor:133}, {Estado:'México',Valor:127}, {Estado:'Jalisco',Valor:118}, {Estado:'Sonora',Valor:102}, {Estado:'Morelos',Valor:90}, ], 'Homicidio culposo': [{Estado:'México',Valor:133}, {Estado:'Michoacán de Ocampo',Valor:124}, {Estado:'Puebla',Valor:119}, {Estado:'Guanajuato',Valor:113}, {Estado:'Oaxaca',Valor:113}, {Estado:'Veracruz de Ignacio de la Llave',Valor:108}, {Estado:'Jalisco',Valor:102}, {Estado:'Quintana Roo',Valor:95}, {Estado:'Chiapas',Valor:79}, {Estado:'Ciudad de México',Valor:68}, ], 'Feminicidio': [{Estado:'Chihuahua',Valor:8}, {Estado:'Baja California',Valor:5}, {Estado:'México',Valor:5}, {Estado:'Puebla',Valor:5}, {Estado:'Ciudad de México',Valor:3}, {Estado:'Jalisco',Valor:3}, {Estado:'Morelos',Valor:3}, {Estado:'Querétaro',Valor:3}, {Estado:'Tabasco',Valor:3}, {Estado:'Tamaulipas',Valor:3}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:264}, {Estado:'Guanajuato',Valor:222}, {Estado:'México',Valor:164}, {Estado:'Querétaro',Valor:128}, {Estado:'Chihuahua',Valor:111}, {Estado:'Ciudad de México',Valor:104}, {Estado:'Sinaloa',Valor:83}, {Estado:'Sonora',Valor:66}, {Estado:'Tabasco',Valor:60}, {Estado:'Morelos',Valor:54}, ], 'Total': [{Estado:'Guanajuato',Valor:511}, {Estado:'Baja California',Valor:441}, {Estado:'México',Valor:429}, {Estado:'Sinaloa',Valor:299}, {Estado:'Michoacán de Ocampo',Valor:297}, {Estado:'Chihuahua',Valor:280}, {Estado:'Ciudad de México',Valor:242}, {Estado:'Jalisco',Valor:234}, {Estado:'Puebla',Valor:231}, {Estado:'Veracruz de Ignacio de la Llave',Valor:214}, ], }, 
'Junio 2025': {'Homicidio doloso': [{Estado:'Sinaloa',Valor:207}, {Estado:'Guanajuato',Valor:171}, {Estado:'Baja California',Valor:162}, {Estado:'Chihuahua',Valor:160}, {Estado:'México',Valor:133}, {Estado:'Michoacán de Ocampo',Valor:119}, {Estado:'Guerrero',Valor:110}, {Estado:'Sonora',Valor:99}, {Estado:'Morelos',Valor:81}, {Estado:'Jalisco',Valor:76}, ], 'Homicidio culposo': [{Estado:'Guanajuato',Valor:137}, {Estado:'Michoacán de Ocampo',Valor:123}, {Estado:'Jalisco',Valor:107}, {Estado:'México',Valor:100}, {Estado:'Quintana Roo',Valor:91}, {Estado:'Veracruz de Ignacio de la Llave',Valor:90}, {Estado:'Oaxaca',Valor:89}, {Estado:'Ciudad de México',Valor:74}, {Estado:'Chiapas',Valor:60}, {Estado:'Puebla',Valor:59}, ], 'Feminicidio': [{Estado:'Michoacán de Ocampo',Valor:5}, {Estado:'Sinaloa',Valor:5}, {Estado:'Tabasco',Valor:5}, {Estado:'Veracruz de Ignacio de la Llave',Valor:5}, {Estado:'Guerrero',Valor:4}, {Estado:'México',Valor:4}, {Estado:'Tamaulipas',Valor:4}, {Estado:'Chiapas',Valor:3}, {Estado:'Ciudad de México',Valor:3}, {Estado:'Jalisco',Valor:3}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:252}, {Estado:'Guanajuato',Valor:196}, {Estado:'México',Valor:125}, {Estado:'Chihuahua',Valor:101}, {Estado:'Ciudad de México',Valor:101}, {Estado:'Sinaloa',Valor:100}, {Estado:'Hidalgo',Valor:98}, {Estado:'Tabasco',Valor:73}, {Estado:'Sonora',Valor:65}, {Estado:'Morelos',Valor:51}, ], 'Total': [{Estado:'Guanajuato',Valor:504}, {Estado:'Baja California',Valor:453}, {Estado:'México',Valor:362}, {Estado:'Sinaloa',Valor:362}, {Estado:'Chihuahua',Valor:298}, {Estado:'Michoacán de Ocampo',Valor:268}, {Estado:'Ciudad de México',Valor:246}, {Estado:'Jalisco',Valor:199}, {Estado:'Sonora',Valor:188}, {Estado:'Veracruz de Ignacio de la Llave',Valor:188}, ], }, 
'Julio 2025': {'Homicidio doloso': [{Estado:'Chihuahua',Valor:182}, {Estado:'Sinaloa',Valor:170}, {Estado:'Guanajuato',Valor:155}, {Estado:'Baja California',Valor:142}, {Estado:'Guerrero',Valor:134}, {Estado:'Jalisco',Valor:124}, {Estado:'México',Valor:113}, {Estado:'Morelos',Valor:103}, {Estado:'Michoacán de Ocampo',Valor:102}, {Estado:'Sonora',Valor:94}, ], 'Homicidio culposo': [{Estado:'México',Valor:116}, {Estado:'Quintana Roo',Valor:109}, {Estado:'Veracruz de Ignacio de la Llave',Valor:92}, {Estado:'Oaxaca',Valor:90}, {Estado:'Michoacán de Ocampo',Valor:82}, {Estado:'Guanajuato',Valor:80}, {Estado:'Ciudad de México',Valor:74}, {Estado:'Chiapas',Valor:69}, {Estado:'Jalisco',Valor:64}, {Estado:'Puebla',Valor:62}, ], 'Feminicidio': [{Estado:'Chihuahua',Valor:5}, {Estado:'Morelos',Valor:4}, {Estado:'Quintana Roo',Valor:4}, {Estado:'Sinaloa',Valor:4}, {Estado:'Tabasco',Valor:4}, {Estado:'Ciudad de México',Valor:3}, {Estado:'Jalisco',Valor:3}, {Estado:'México',Valor:3}, {Estado:'Oaxaca',Valor:3}, {Estado:'Veracruz de Ignacio de la Llave',Valor:3}, ], 'Otros delitos que atentan contra la vida y la integridad corporal': [{Estado:'Baja California',Valor:281}, {Estado:'Guanajuato',Valor:225}, {Estado:'México',Valor:118}, {Estado:'Tabasco',Valor:113}, {Estado:'Ciudad de México',Valor:86}, {Estado:'Hidalgo',Valor:85}, {Estado:'Chihuahua',Valor:73}, {Estado:'Sonora',Valor:58}, {Estado:'Morelos',Valor:55}, {Estado:'Sinaloa',Valor:49}, ], 'Total': [{Estado:'Baja California',Valor:462}, {Estado:'Guanajuato',Valor:460}, {Estado:'México',Valor:350}, {Estado:'Chihuahua',Valor:292}, {Estado:'Sinaloa',Valor:270}, {Estado:'Ciudad de México',Valor:224}, {Estado:'Michoacán de Ocampo',Valor:216}, {Estado:'Tabasco',Valor:210}, {Estado:'Veracruz de Ignacio de la Llave',Valor:207}, {Estado:'Jalisco',Valor:200}, ], }
};

        // Función para crear la Tabla 1: Violencia homicida por tipo de delito (2019-2025)
        function createIDVFCTable() {
            const container = document.getElementById('tabla-violencia-homicida-idvfc');
            if (!container) {
                return;
            }

            const table = document.createElement('table');
            table.className = 'data-table';
            
            // Headers
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            
            const orderedHeaders = ['Delito', '2019', '2020', '2021', '2022', '2023', '2024', '2025', 'Total'];
            orderedHeaders.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            // Datos
            const tbody = document.createElement('tbody');
            
            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            const años = [2019, 2020, 2021, 2022, 2023, 2024, 2025];
            
            delitos.forEach(delito => {
                const row = idvfcViolenciaHomicidaData.find(r => r.Delito === delito);
                if (row) {
                    const tr = document.createElement('tr');
                    orderedHeaders.forEach((header, colIndex) => {
                        const td = document.createElement('td');
                        let value = row[header];
                        
                        if (colIndex === 0 || header === 'Delito') {
                            let displayValue = value;
                            if (value === 'Otros delitos que atentan contra la vida y la integridad corporal') {
                                displayValue = 'Otros delitos contra la vida';
                            }
                            td.textContent = displayValue;
                            td.style.fontWeight = '500';
                        } else if (header === 'Total') {
                            const total = años.reduce((sum, año) => sum + (parseInt(row[año]) || 0), 0);
                            td.textContent = total.toLocaleString();
                            td.style.fontWeight = 'bold';
                            td.style.backgroundColor = '#f8f9fa';
                        } else {
                            td.textContent = parseInt(value).toLocaleString();
                            td.style.textAlign = 'center';
                        }
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                }
            });
            
            // Fila total
            const totalRow = { Delito: 'Total' };
            años.forEach(año => {
                totalRow[año.toString()] = delitos.reduce((sum, delito) => {
                    const row = idvfcViolenciaHomicidaData.find(r => r.Delito === delito);
                    return sum + (parseInt(row[año]) || 0);
                }, 0);
            });
            
            // Calcular total general
            totalRow['Total'] = años.reduce((sum, año) => sum + totalRow[año], 0);
            
            const tr = document.createElement('tr');
            orderedHeaders.forEach((header, colIndex) => {
                const td = document.createElement('td');
                if (colIndex === 0) {
                    td.textContent = 'Total';
                    td.style.fontWeight = 'bold';
                } else {
                    const value = totalRow[header];
                    td.textContent = parseInt(value).toLocaleString();
                    td.style.textAlign = 'center';
                    td.style.fontWeight = 'bold';
                    td.style.backgroundColor = '#e9ecef';
                }
                tr.appendChild(td);
            });
            tbody.appendChild(tr);
            
            table.appendChild(tbody);
            
            // Nota de fuente
            const sourceNote = document.createElement('p');
            sourceNote.style.fontSize = '12px';
            sourceNote.style.marginTop = '10px';
            sourceNote.style.color = '#666';
            sourceNote.innerHTML = '<strong>Fuente:</strong> SESNSP (IDVFC_NM_jul25.csv). Datos de enero a julio por año.';
            
            container.innerHTML = '';
            container.appendChild(table);
            container.appendChild(sourceNote);
        }

        // Función para crear la Tabla 1.1: Contribución de cada delito al cambio 2024-2025
        function createIDVFCContribucionTable() {
            const container = document.getElementById('tabla-contribucion-cambio-idvfc');
            if (!container) {
                return;
            }

            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            // Calcular cambios 2024-2025
            const cambios = [];
            delitos.forEach(delito => {
                const valor2024 = idvfcViolenciaHomicidaData.find(r => r.Delito === delito)['2024'];
                const valor2025 = idvfcViolenciaHomicidaData.find(r => r.Delito === delito)['2025'];
                const cambio = valor2025 - valor2024;
                const cambioPorcentual = ((cambio / valor2024) * 100).toFixed(1);
                
                cambios.push({
                    delito: delito === 'Otros delitos que atentan contra la vida y la integridad corporal' ? 'Otros delitos contra la vida' : delito,
                    valor2024: valor2024,
                    valor2025: valor2025,
                    cambio: cambio,
                    cambioPorcentual: cambioPorcentual
                });
            });

            // Calcular total
            const total2024 = idvfcViolenciaHomicidaData.find(r => r.Delito === 'Total')['2024'];
            const total2025 = idvfcViolenciaHomicidaData.find(r => r.Delito === 'Total')['2025'];
            const cambioTotal = total2025 - total2024;
            const cambioPorcentualTotal = ((cambioTotal / total2024) * 100).toFixed(1);

            // Calcular contribución de cada delito al cambio total
            cambios.forEach(cambio => {
                cambio.contribucion = ((cambio.cambio / cambioTotal) * 100).toFixed(1);
            });

            // Crear tabla
            const table = document.createElement('table');
            table.className = 'data-table';
            
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            const headers = ['Delito', '2024', '2025', 'Cambio', 'Cambio %', 'Contribución al cambio total'];
            
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            const tbody = document.createElement('tbody');
            
            // Filas de delitos
            cambios.forEach(cambio => {
                const tr = document.createElement('tr');
                
                const td1 = document.createElement('td');
                td1.textContent = cambio.delito;
                td1.style.fontWeight = '500';
                tr.appendChild(td1);
                
                const td2 = document.createElement('td');
                td2.textContent = cambio.valor2024.toLocaleString();
                td2.style.textAlign = 'center';
                tr.appendChild(td2);
                
                const td3 = document.createElement('td');
                td3.textContent = cambio.valor2025.toLocaleString();
                td3.style.textAlign = 'center';
                tr.appendChild(td3);
                
                const td4 = document.createElement('td');
                td4.textContent = cambio.cambio.toLocaleString();
                td4.style.textAlign = 'center';
                td4.style.color = cambio.cambio >= 0 ? '#e74c3c' : '#27ae60';
                tr.appendChild(td4);
                
                const td5 = document.createElement('td');
                td5.textContent = cambio.cambioPorcentual + '%';
                td5.style.textAlign = 'center';
                td5.style.color = cambio.cambioPorcentual >= 0 ? '#e74c3c' : '#27ae60';
                tr.appendChild(td5);
                
                const td6 = document.createElement('td');
                td6.textContent = cambio.contribucion + '%';
                td6.style.textAlign = 'center';
                td6.style.fontWeight = 'bold';
                tr.appendChild(td6);
                
                tbody.appendChild(tr);
            });
            
            // Fila total
            const trTotal = document.createElement('tr');
            trTotal.style.backgroundColor = '#34495e';
            trTotal.style.color = 'white';
            trTotal.style.fontWeight = 'bold';
            
            const td1Total = document.createElement('td');
            td1Total.textContent = 'TOTAL';
            trTotal.appendChild(td1Total);
            
            const td2Total = document.createElement('td');
            td2Total.textContent = total2024.toLocaleString();
            td2Total.style.textAlign = 'center';
            trTotal.appendChild(td2Total);
            
            const td3Total = document.createElement('td');
            td3Total.textContent = total2025.toLocaleString();
            td3Total.style.textAlign = 'center';
            trTotal.appendChild(td3Total);
            
            const td4Total = document.createElement('td');
            td4Total.textContent = cambioTotal.toLocaleString();
            td4Total.style.textAlign = 'center';
            trTotal.appendChild(td4Total);
            
            const td5Total = document.createElement('td');
            td5Total.textContent = cambioPorcentualTotal + '%';
            td5Total.style.textAlign = 'center';
            trTotal.appendChild(td5Total);
            
            const td6Total = document.createElement('td');
            td6Total.textContent = '100%';
            td6Total.style.textAlign = 'center';
            trTotal.appendChild(td6Total);
            
            tbody.appendChild(trTotal);
            table.appendChild(tbody);
            
            container.innerHTML = '';
            container.appendChild(table);
        }

        // Función para crear la Gráfica 2: Cambios porcentuales anuales
        function createIDVFCCambiosAnualesChart() {
            const ctx = document.getElementById('chart-cambios-nacional-idvfc');
            if (!ctx) {
                return;
            }

            // Destruir gráfica existente si existe
            if (window.idvfcCambiosAnualesChart) {
                window.idvfcCambiosAnualesChart.destroy();
            }

            const años = [2019, 2020, 2021, 2022, 2023, 2024, 2025];
            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            // Calcular cambios porcentuales año con año
            const datasets = [];
            
            delitos.forEach((delito, index) => {
                const colors = ['#2ecc71', '#e74c3c', '#3498db', '#f39c12'];
                const cambios = [];
                
                for (let i = 1; i < años.length; i++) {
                    const añoAnterior = años[i-1];
                    const añoActual = años[i];
                    const valorAnterior = idvfcViolenciaHomicidaData.find(r => r.Delito === delito)[añoAnterior.toString()];
                    const valorActual = idvfcViolenciaHomicidaData.find(r => r.Delito === delito)[añoActual.toString()];
                    
                    if (valorAnterior > 0) {
                        const cambio = ((valorActual - valorAnterior) / valorAnterior * 100).toFixed(1);
                        cambios.push(parseFloat(cambio));
                    } else {
                        cambios.push(0);
                    }
                }
                
                datasets.push({
                    label: delito === 'Otros delitos que atentan contra la vida y la integridad corporal' ? 'Otros delitos contra la vida' : delito,
                    data: cambios,
                    type: 'line',
                    borderColor: colors[index],
                    backgroundColor: colors[index],
                    borderWidth: 3,
                    fill: false,
                    tension: 0,
                    pointRadius: 0,
                    pointHoverRadius: 6,
                    order: index + 1
                });
            });
            
            // Calcular cambios totales
            const cambiosTotales = [];
            for (let i = 1; i < años.length; i++) {
                const añoAnterior = años[i-1];
                const añoActual = años[i];
                const totalAnterior = idvfcViolenciaHomicidaData.find(r => r.Delito === 'Total')[añoAnterior.toString()];
                const totalActual = idvfcViolenciaHomicidaData.find(r => r.Delito === 'Total')[añoActual.toString()];
                
                if (totalAnterior > 0) {
                    const cambio = ((totalActual - totalAnterior) / totalAnterior * 100).toFixed(1);
                    cambiosTotales.push(parseFloat(cambio));
                } else {
                    cambiosTotales.push(0);
                }
            }
            
            datasets.push({
                label: 'Violencia homicida total',
                data: cambiosTotales,
                type: 'line',
                borderColor: '#34495e',
                backgroundColor: '#34495e',
                borderWidth: 2,
                borderDash: [5, 5],
                fill: false,
                tension: 0,
                pointRadius: 0,
                pointHoverRadius: 6,
                order: 5
            });

            const chart = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['2020', '2021', '2022', '2023', '2024', '2025'],
                    datasets: datasets 
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: { 
                        legend: { 
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            borderColor: '#3498db',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed.y.toFixed(1);
                                    return `${context.dataset.label}: ${value}%`;
                                }
                            }
                        }
                    },
                    scales: { 
                        y: { 
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cambio porcentual (%)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Año'
                            }
                        }
                    }
                }
            });

            // Guardar referencia global para evitar conflictos
            window.idvfcCambiosAnualesChart = chart;
        }

        // Función para crear la Tabla 2: Cambios porcentuales anuales a nivel nacional
        function createIDVFCCambiosAnualesTable() {
            const container = document.getElementById('tabla-cambios-nacional-idvfc');
            if (!container) {
                return;
            }

            const años = [2019, 2020, 2021, 2022, 2023, 2024, 2025];
            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            // Crear tabla
            const table = document.createElement('table');
            table.className = 'data-table';
            
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            const headers = ['Delito', '2020', '2021', '2022', '2023', '2024', '2025'];
            
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            const tbody = document.createElement('tbody');
            
            // Filas de delitos
            delitos.forEach(delito => {
                const tr = document.createElement('tr');
                
                const td1 = document.createElement('td');
                td1.textContent = delito === 'Otros delitos que atentan contra la vida y la integridad corporal' ? 'Otros delitos contra la vida' : delito;
                td1.style.fontWeight = '500';
                tr.appendChild(td1);
                
                // Calcular cambios porcentuales año con año
                for (let i = 1; i < años.length; i++) {
                    const añoAnterior = años[i-1];
                    const añoActual = años[i];
                    const valorAnterior = idvfcViolenciaHomicidaData.find(r => r.Delito === delito)[añoAnterior.toString()];
                    const valorActual = idvfcViolenciaHomicidaData.find(r => r.Delito === delito)[añoActual.toString()];
                    
                    const td = document.createElement('td');
                    if (valorAnterior > 0) {
                        const cambio = ((valorActual - valorAnterior) / valorAnterior * 100).toFixed(1);
                        td.textContent = cambio + '%';
                        td.style.color = cambio >= 0 ? '#e74c3c' : '#27ae60';
                    } else if (valorAnterior === 0 && valorActual === 0) {
                        td.textContent = '0.0%';
                        td.style.color = '#6c757d';
                    } else if (valorAnterior === 0 && valorActual > 0) {
                        td.textContent = '+∞%';
                        td.style.color = '#e74c3c';
                    } else {
                        td.textContent = 'N/A';
                        td.style.color = '#6c757d';
                    }
                    td.style.textAlign = 'center';
                    tr.appendChild(td);
                }
                    
                tbody.appendChild(tr);
            });
            
            // Fila total
            const trTotal = document.createElement('tr');
            trTotal.style.backgroundColor = '#34495e';
            trTotal.style.color = 'white';
            trTotal.style.fontWeight = 'bold';
            
            const td1Total = document.createElement('td');
            td1Total.textContent = 'TOTAL';
            trTotal.appendChild(td1Total);
            
            // Calcular cambios porcentuales totales
            for (let i = 1; i < años.length; i++) {
                const añoAnterior = años[i-1];
                const añoActual = años[i];
                const totalAnterior = idvfcViolenciaHomicidaData.find(r => r.Delito === 'Total')[añoAnterior.toString()];
                const totalActual = idvfcViolenciaHomicidaData.find(r => r.Delito === 'Total')[añoActual.toString()];
                
                const td = document.createElement('td');
                if (totalAnterior > 0) {
                    const cambio = ((totalActual - totalAnterior) / totalAnterior * 100).toFixed(1);
                    td.textContent = cambio + '%';
                } else {
                    td.textContent = 'N/A';
                }
                td.style.textAlign = 'center';
                trTotal.appendChild(td);
            }
            
            tbody.appendChild(trTotal);
            table.appendChild(tbody);
            
            container.innerHTML = '';
            container.appendChild(table);
        }

        // Función para crear la Gráfica 3: Evolución mensual nacional
        function createIDVFCMensualChart() {
            const ctx = document.getElementById('chart-violencia-mensual-idvfc');
            if (!ctx) {
                return;
            }

            // Destruir gráfica existente si existe
            if (window.idvfcMensualChart) {
                window.idvfcMensualChart.destroy();
            }

            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            // Extraer datos básicos
            const periodos = idvfcViolenciaHomicidaMensualData.map(row => row.Periodo);
            const totales = idvfcViolenciaHomicidaMensualData.map(row => parseInt(row.Total) || 0);
            
            const datasets = [];
            
            delitos.forEach((delito, index) => {
                const colors = ['#2ecc71', '#e74c3c', '#3498db', '#f39c12'];
                const datos = idvfcViolenciaHomicidaMensualData.map(row => parseInt(row[delito]) || 0);
                
                datasets.push({
                    label: delito === 'Otros delitos que atentan contra la vida y la integridad corporal' ? 'Otros delitos contra la vida' : delito,
                    data: datos,
                    type: 'line',
                    borderColor: colors[index],
                    backgroundColor: colors[index],
                    borderWidth: 3,
                    fill: false,
                    tension: 0,
                    pointRadius: 0,
                    pointHoverRadius: 6,
                    order: index + 1
                });
            });
            
            datasets.push({
                label: 'Total',
                data: totales,
                type: 'bar',
                backgroundColor: '#34495e',
                borderColor: '#34495e',
                borderWidth: 1,
                order: 5
            });

            const chart = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: periodos,
                    datasets: datasets 
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: { 
                        legend: { 
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            borderColor: '#3498db',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const value = new Intl.NumberFormat('es-MX').format(context.parsed.y);
                                    return `${context.dataset.label}: ${value}`;
                                }
                            }
                        }
                    },
                    scales: { 
                        y: { 
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Número de casos'
                            },
                            ticks: {
                                callback: function(value) {
                                    return new Intl.NumberFormat('es-MX').format(value);
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Período'
                            }
                        }
                    }
                }
            });

            // Guardar referencia global para evitar conflictos
            window.idvfcMensualChart = chart;
        }

        // Función para crear la Tabla 3: Violencia homicida mensual a nivel nacional
        function createIDVFCMensualTable() {
            const container = document.getElementById('tabla-violencia-mensual-idvfc');
            if (!container) {
                return;
            }

            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            // Crear tabla
            const table = document.createElement('table');
            table.className = 'data-table';
            
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            const headers = ['Período', 'Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos contra la vida', 'Total'];
            
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            const tbody = document.createElement('tbody');
            
            // Filas de datos mensuales
            idvfcViolenciaHomicidaMensualData.forEach(periodo => {
                const tr = document.createElement('tr');
                
                const td1 = document.createElement('td');
                td1.textContent = periodo.Periodo;
                td1.style.fontWeight = '500';
                tr.appendChild(td1);
                
                const td2 = document.createElement('td');
                td2.textContent = periodo['Homicidio doloso'].toLocaleString();
                td2.style.textAlign = 'center';
                tr.appendChild(td2);
                
                const td3 = document.createElement('td');
                td3.textContent = periodo['Homicidio culposo'].toLocaleString();
                td3.style.textAlign = 'center';
                tr.appendChild(td3);
                
                const td4 = document.createElement('td');
                td4.textContent = periodo['Feminicidio'].toLocaleString();
                td4.style.textAlign = 'center';
                tr.appendChild(td4);
                
                const td5 = document.createElement('td');
                td5.textContent = periodo['Otros delitos que atentan contra la vida y la integridad corporal'].toLocaleString();
                td5.style.textAlign = 'center';
                tr.appendChild(td5);
                
                const td6 = document.createElement('td');
                td6.textContent = periodo.Total.toLocaleString();
                td6.style.textAlign = 'center';
                td6.style.fontWeight = 'bold';
                td6.style.backgroundColor = '#f8f9fa';
                tr.appendChild(td6);
                
                tbody.appendChild(tr);
            });
            
            table.appendChild(tbody);
            
            container.innerHTML = '';
            container.appendChild(table);
        }

        // Función para crear la Gráfica 4: Cambios porcentuales mensuales
        function createIDVFCCambiosMensualesChart() {
            const ctx = document.getElementById('chart-cambios-mensual-nacional-idvfc');
            if (!ctx) {
                return;
            }

            // Destruir gráfica existente si existe
            if (window.idvfcCambiosMensualesChart) {
                window.idvfcCambiosMensualesChart.destroy();
            }

            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            // Calcular cambios porcentuales mes con mes
            const datasets = [];
            
            delitos.forEach((delito, index) => {
                const colors = ['#2ecc71', '#e74c3c', '#3498db', '#f39c12'];
                const cambios = [];
                
                for (let i = 1; i < idvfcViolenciaHomicidaMensualData.length; i++) {
                    const mesAnterior = idvfcViolenciaHomicidaMensualData[i-1];
                    const mesActual = idvfcViolenciaHomicidaMensualData[i];
                    const valorAnterior = mesAnterior[delito];
                    const valorActual = mesActual[delito];
                    
                    if (valorAnterior > 0) {
                        const cambio = ((valorActual - valorAnterior) / valorAnterior * 100).toFixed(1);
                        cambios.push(parseFloat(cambio));
                    } else if (valorAnterior === 0 && valorActual === 0) {
                        cambios.push(0);
                    } else if (valorAnterior === 0 && valorActual > 0) {
                        cambios.push(100); // +100% para casos de 0 a >0
                    } else {
                        cambios.push(0);
                    }
                }
                
                datasets.push({
                    label: delito === 'Otros delitos que atentan contra la vida y la integridad corporal' ? 'Otros delitos contra la vida' : delito,
                    data: cambios,
                    type: 'line',
                    borderColor: colors[index],
                    backgroundColor: colors[index],
                    borderWidth: 3,
                    fill: false,
                    tension: 0,
                    pointRadius: 0,
                    pointHoverRadius: 6,
                    order: index + 1
                });
            });
            
            // Calcular cambios totales mensuales
            const cambiosTotales = [];
            for (let i = 1; i < idvfcViolenciaHomicidaMensualData.length; i++) {
                const mesAnterior = idvfcViolenciaHomicidaMensualData[i-1];
                const mesActual = idvfcViolenciaHomicidaMensualData[i];
                const totalAnterior = mesAnterior.Total;
                const totalActual = mesActual.Total;
                
                if (totalAnterior > 0) {
                    const cambio = ((totalActual - totalAnterior) / totalAnterior * 100).toFixed(1);
                    cambiosTotales.push(parseFloat(cambio));
                } else {
                    cambiosTotales.push(0);
                }
            }
            
            datasets.push({
                label: 'Violencia homicida total',
                data: cambiosTotales,
                type: 'line',
                borderColor: '#34495e',
                backgroundColor: '#34495e',
                borderWidth: 2,
                borderDash: [5, 5],
                fill: false,
                tension: 0,
                pointRadius: 0,
                pointHoverRadius: 6,
                order: 5
            });

            // Crear etiquetas de meses (excluyendo el primer mes ya que no hay cambio)
            const labels = idvfcViolenciaHomicidaMensualData.slice(1).map(row => row.Periodo);

            const chart = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: labels,
                    datasets: datasets 
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: { 
                        legend: { 
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            borderColor: '#3498db',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed.y.toFixed(1);
                                    return `${context.dataset.label}: ${value}%`;
                                }
                            }
                        }
                    },
                    scales: { 
                        y: { 
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cambio porcentual (%)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Período'
                            }
                        }
                    }
                }
            });

            // Guardar referencia global para evitar conflictos
            window.idvfcCambiosMensualesChart = chart;
        }

        // Función para crear la Tabla 4: Cambios porcentuales mensuales a nivel nacional
        function createIDVFCCambiosMensualesTable() {
            const container = document.getElementById('tabla-cambios-mensual-nacional-idvfc');
            if (!container) {
                return;
            }

            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            // Crear tabla
            const table = document.createElement('table');
            table.className = 'data-table';
            
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            
            // Primera columna es el delito
            const th1 = document.createElement('th');
            th1.textContent = 'Delito';
            headerRow.appendChild(th1);
            
            // Columnas de meses (excluyendo el primer mes ya que no hay cambio)
            const mesesCambio = idvfcViolenciaHomicidaMensualData.slice(1).map(row => row.Periodo);
            mesesCambio.forEach(mes => {
                const th = document.createElement('th');
                th.textContent = mes;
                headerRow.appendChild(th);
            });
            
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            const tbody = document.createElement('tbody');
            
            // Filas de delitos
            delitos.forEach(delito => {
                const tr = document.createElement('tr');
                
                const td1 = document.createElement('td');
                td1.textContent = delito === 'Otros delitos que atentan contra la vida y la integridad corporal' ? 'Otros delitos contra la vida' : delito;
                td1.style.fontWeight = '500';
                tr.appendChild(td1);
                
                // Calcular cambios porcentuales mes con mes
                for (let i = 1; i < idvfcViolenciaHomicidaMensualData.length; i++) {
                    const mesAnterior = idvfcViolenciaHomicidaMensualData[i-1];
                    const mesActual = idvfcViolenciaHomicidaMensualData[i];
                    const valorAnterior = mesAnterior[delito];
                    const valorActual = mesActual[delito];
                    
                    const td = document.createElement('td');
                    if (valorAnterior > 0) {
                        const cambio = ((valorActual - valorAnterior) / valorAnterior * 100).toFixed(1);
                        td.textContent = cambio + '%';
                        td.style.color = cambio >= 0 ? '#e74c3c' : '#27ae60';
                    } else if (valorAnterior === 0 && valorActual === 0) {
                        td.textContent = '0.0%';
                        td.style.color = '#6c757d';
                    } else if (valorAnterior === 0 && valorActual > 0) {
                        td.textContent = '+∞%';
                        td.style.color = '#e74c3c';
                    } else {
                        td.textContent = 'N/A';
                        td.style.color = '#6c757d';
                    }
                    td.style.textAlign = 'center';
                    tr.appendChild(td);
                }
                
                tbody.appendChild(tr);
            });
            
            // Fila total
            const trTotal = document.createElement('tr');
            trTotal.style.backgroundColor = '#34495e';
            trTotal.style.color = 'white';
            trTotal.style.fontWeight = 'bold';
            
            const td1Total = document.createElement('td');
            td1Total.textContent = 'TOTAL';
            trTotal.appendChild(td1Total);
            
            // Calcular cambios porcentuales totales mes con mes
            for (let i = 1; i < idvfcViolenciaHomicidaMensualData.length; i++) {
                const mesAnterior = idvfcViolenciaHomicidaMensualData[i-1];
                const mesActual = idvfcViolenciaHomicidaMensualData[i];
                const totalAnterior = mesAnterior.Total;
                const totalActual = mesActual.Total;
                
                const td = document.createElement('td');
                if (totalAnterior > 0) {
                    const cambio = ((totalActual - totalAnterior) / totalAnterior * 100).toFixed(1);
                    td.textContent = cambio + '%';
                } else {
                    td.textContent = '0.0%';
                }
                td.style.textAlign = 'center';
                trTotal.appendChild(td);
            }
            
            tbody.appendChild(trTotal);
            table.appendChild(tbody);
            
            container.innerHTML = '';
            container.appendChild(table);
        }

        // Función para crear la Gráfica 5: Tasas por 100,000 habitantes
        function createIDVFCRatesChart() {
            const ctx = document.getElementById('chart-violencia-homicida-rates-idvfc');
            if (!ctx) {
                return;
            }

            // Destruir gráfica existente si existe
            if (window.idvfcRatesChart) {
                window.idvfcRatesChart.destroy();
            }

            const años = [2019, 2020, 2021, 2022, 2023, 2024, 2025];
            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            // Convertir datos a tasas por 100,000 habitantes
            const ratesData = [];
            
            delitos.forEach(delito => {
                const rateRow = { Delito: delito };
                años.forEach(año => {
                    const casos = idvfcViolenciaHomicidaData.find(r => r.Delito === delito)[año.toString()];
                    const poblacion = idvfcPoblacionNacional[año.toString()];
                    rateRow[año.toString()] = calculateIDVFCRate(casos, poblacion);
                });
                ratesData.push(rateRow);
            });
            
            // Agregar fila total
            const totalRow = { Delito: 'Total' };
            años.forEach(año => {
                const totalCasos = idvfcViolenciaHomicidaData.find(r => r.Delito === 'Total')[año.toString()];
                const poblacion = idvfcPoblacionNacional[año.toString()];
                totalRow[año.toString()] = calculateIDVFCRate(totalCasos, poblacion);
            });
            ratesData.push(totalRow);
            
            const totales = años.map(año => totalRow[año.toString()] || 0);
            
            const datasets = [];
            
            delitos.forEach((delito, index) => {
                const delitoRow = ratesData.find(row => row.Delito === delito);
                if (delitoRow) {
                    const colors = ['#2ecc71', '#e74c3c', '#3498db', '#f39c12'];
                    datasets.push({
                        label: delito === 'Otros delitos que atentan contra la vida y la integridad corporal' ? 'Otros delitos contra la vida' : delito,
                        data: años.map(año => delitoRow[año.toString()] || 0),
                        type: 'line',
                        borderColor: colors[index],
                        backgroundColor: colors[index],
                        borderWidth: 3,
                        fill: false,
                        tension: 0,
                        pointRadius: 0,
                        pointHoverRadius: 6,
                        order: index + 1
                    });
                }
            });
            
            datasets.push({
                label: 'Violencia homicida',
                data: totales,
                type: 'bar',
                backgroundColor: '#34495e',
                borderColor: '#34495e',
                borderWidth: 1,
                order: 5
            });

            const chart = new Chart(ctx, {
                type: 'bar',
                data: { labels: años, datasets: datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: { 
                        legend: { 
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            borderColor: '#3498db',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed.y.toFixed(2);
                                    return `${context.dataset.label}: ${value} por 100,000 hab`;
                                }
                            }
                        }
                    },
                    scales: { 
                        y: { 
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Tasa por 100,000 habitantes'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toFixed(2);
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Año'
                            }
                        }
                    }
                }
            });

            // Guardar referencia global para evitar conflictos
            window.idvfcRatesChart = chart;
        }

        // Función para crear la Gráfica 5: Tasas por 100,000 habitantes
        function createIDVFCRatesChart() {
            const ctx = document.getElementById('chart-violencia-homicida-rates-idvfc');
            if (!ctx) {
                return;
            }

            // Destruir gráfica existente si existe
            if (window.idvfcRatesChart) {
                window.idvfcRatesChart.destroy();
            }

            const años = [2019, 2020, 2021, 2022, 2023, 2024, 2025];
            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            // Convertir datos a tasas por 100,000 habitantes
            const ratesData = [];
            
            delitos.forEach(delito => {
                const rateRow = { Delito: delito };
                años.forEach(año => {
                    const casos = idvfcViolenciaHomicidaData.find(r => r.Delito === delito)[año.toString()];
                    const poblacion = idvfcPoblacionNacional[año.toString()];
                    rateRow[año.toString()] = calculateIDVFCRate(casos, poblacion);
                });
                ratesData.push(rateRow);
            });
            
            // Agregar fila total
            const totalRow = { Delito: 'Total' };
            años.forEach(año => {
                const totalCasos = idvfcViolenciaHomicidaData.find(r => r.Delito === 'Total')[año.toString()];
                const poblacion = idvfcPoblacionNacional[año.toString()];
                totalRow[año.toString()] = calculateIDVFCRate(totalCasos, poblacion);
            });
            ratesData.push(totalRow);
            
            const totales = años.map(año => totalRow[año.toString()] || 0);
            
            const datasets = [];
            
            delitos.forEach((delito, index) => {
                const delitoRow = ratesData.find(row => row.Delito === delito);
                if (delitoRow) {
                    const colors = ['#2ecc71', '#e74c3c', '#3498db', '#f39c12'];
                    datasets.push({
                        label: delito === 'Otros delitos que atentan contra la vida y la integridad corporal' ? 'Otros delitos contra la vida' : delito,
                        data: años.map(año => delitoRow[año.toString()] || 0),
                        type: 'line',
                        borderColor: colors[index],
                        backgroundColor: colors[index],
                        borderWidth: 3,
                        fill: false,
                        tension: 0,
                        pointRadius: 0,
                        pointHoverRadius: 6,
                        order: index + 1
                    });
                }
            });
            
            datasets.push({
                label: 'Violencia homicida',
                data: totales,
                type: 'bar',
                backgroundColor: '#34495e',
                borderColor: '#34495e',
                borderWidth: 1,
                order: 5
            });

            const chart = new Chart(ctx, {
                type: 'bar',
                data: { labels: años, datasets: datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: { 
                        legend: { 
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            borderColor: '#3498db',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed.y.toFixed(2);
                                    return `${context.dataset.label}: ${value} por 100,000 hab`;
                                }
                            }
                        }
                    },
                    scales: { 
                        y: { 
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Tasa por 100,000 habitantes'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toFixed(2);
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Año'
                            }
                        }
                    }
                }
            });

            // Guardar referencia global para evitar conflictos
            window.idvfcRatesChart = chart;
        }

        // Función para crear la Tabla 5: Tasas por 100,000 habitantes
        function createIDVFCRatesTable() {
            const container = document.getElementById('tabla-violencia-homicida-rates-idvfc');
            if (!container) {
                return;
            }

            const años = [2019, 2020, 2021, 2022, 2023, 2024, 2025];
            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            // Convertir datos a tasas por 100,000 habitantes
            const ratesData = [];
            
            delitos.forEach(delito => {
                const rateRow = { Delito: delito };
                años.forEach(año => {
                    const casos = idvfcViolenciaHomicidaData.find(r => r.Delito === delito)[año.toString()];
                    const poblacion = idvfcPoblacionNacional[año.toString()];
                    rateRow[año.toString()] = calculateIDVFCRate(casos, poblacion);
                });
                ratesData.push(rateRow);
            });
            
            // Agregar fila total
            const totalRow = { Delito: 'Total' };
            años.forEach(año => {
                const totalCasos = idvfcViolenciaHomicidaData.find(r => r.Delito === 'Total')[año.toString()];
                const poblacion = idvfcPoblacionNacional[año.toString()];
                totalRow[año.toString()] = calculateIDVFCRate(totalCasos, poblacion);
            });
            ratesData.push(totalRow);

            const table = document.createElement('table');
            table.className = 'data-table';
            
            // Orden específico de columnas para la tabla de tasas
            const orderedHeaders = ['Delito', '2019', '2020', '2021', '2022', '2023', '2024', '2025', 'Total'];
            
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            
            orderedHeaders.forEach(header => {
                const th = document.createElement('th');
                let displayName = header;
                if (header === 'Otros delitos que atentan contra la vida y la integridad corporal') {
                    displayName = 'Otros delitos contra la vida';
                }
                th.textContent = displayName;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            const tbody = document.createElement('tbody');
            
            // Orden deseado de los subtipos de delitos
            const ordenDelitos = [
                'Homicidio doloso',
                'Homicidio culposo', 
                'Otros delitos que atentan contra la vida y la integridad corporal',
                'Feminicidio'
            ];
            
            // Crear filas en el orden deseado
            ordenDelitos.forEach(delito => {
                const row = ratesData.find(r => r.Delito === delito);
                if (row) {
                    const tr = document.createElement('tr');
                    orderedHeaders.forEach((header, colIndex) => {
                        const td = document.createElement('td');
                        let value = row[header];
                        
                        if (colIndex === 0 || header === 'Delito') {
                            let displayValue = value;
                            if (value === 'Otros delitos que atentan contra la vida y la integridad corporal') {
                                displayValue = 'Otros delitos contra la vida';
                            }
                            td.textContent = displayValue;
                            td.style.textAlign = 'left';
                            td.style.fontWeight = '500';
                        } else if (header === 'Total') {
                            // Calcular el total de la fila (promedio de todos los años)
                            const años = ['2019', '2020', '2021', '2022', '2023', '2024', '2025'];
                            const totalFila = años.reduce((sum, año) => sum + (row[año] || 0), 0) / años.length;
                            td.textContent = totalFila.toFixed(2);
                            td.style.textAlign = 'center';
                            td.style.fontWeight = 'bold';
                        } else {
                            td.textContent = isNaN(value) ? value : value.toFixed(2);
                            td.style.textAlign = 'center';
                        }
                        
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                }
            });
            
            // Agregar la fila total al final
            const trTotal = document.createElement('tr');
            trTotal.style.backgroundColor = '#34495e';
            trTotal.style.color = 'white';
            trTotal.style.fontWeight = 'bold';
            
            orderedHeaders.forEach((header, colIndex) => {
                const td = document.createElement('td');
                const value = totalRow[header];
                
                if (colIndex === 0 || header === 'Delito') {
                    td.textContent = value;
                    td.style.textAlign = 'left';
                    td.style.fontWeight = '500';
                } else if (header === 'Total') {
                    // Calcular promedio total
                    const años = ['2019', '2020', '2021', '2022', '2023', '2024', '2025'];
                    const promedioTotal = años.reduce((sum, año) => sum + (totalRow[año] || 0), 0) / años.length;
                    td.textContent = promedioTotal.toFixed(2);
                } else {
                    td.textContent = isNaN(value) ? value : value.toFixed(2);
                    td.style.textAlign = 'center';
                }
                
                trTotal.appendChild(td);
            });
            
            tbody.appendChild(trTotal);
            table.appendChild(tbody);
            
            container.innerHTML = '';
            container.appendChild(table);
        }

        // Función para crear la Tabla 6: Nivel de violencia homicida a nivel estatal (2025)
        function createIDVFCEstatalTable() {
            const container = document.getElementById('tabla-estatal-idvfc-2025');
            if (!container) {
                return;
            }

            // Crear controles de ordenamiento
            const controlsDiv = document.createElement('div');
            controlsDiv.className = 'table-controls';
            controlsDiv.style.marginBottom = '15px';
            controlsDiv.style.padding = '10px';
            controlsDiv.style.backgroundColor = '#f8f9fa';
            controlsDiv.style.borderRadius = '5px';
            controlsDiv.style.border = '1px solid #dee2e6';

            const label = document.createElement('label');
            label.textContent = 'Ordenar por: ';
            label.style.fontWeight = 'bold';
            label.style.marginRight = '10px';

            const select = document.createElement('select');
            select.id = 'sort-select-idvfc';
            select.style.padding = '5px 10px';
            select.style.borderRadius = '3px';
            select.style.border = '1px solid #ccc';
            select.style.fontSize = '14px';

            // Opciones de ordenamiento
            const sortOptions = [
                { value: 'Total', text: 'Violencia homicida total' },
                { value: 'Homicidio doloso', text: 'Homicidios dolosos' },
                { value: 'Homicidio culposo', text: 'Homicidios culposos' },
                { value: 'Feminicidio', text: 'Feminicidios' },
                { value: 'Otros delitos que atentan contra la vida y la integridad corporal', text: 'Otros delitos contra la vida' }
            ];

            sortOptions.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option.value;
                optionElement.textContent = option.text;
                if (option.value === 'Homicidio doloso') {
                    optionElement.selected = true;
                }
                select.appendChild(optionElement);
            });

            controlsDiv.appendChild(label);
            controlsDiv.appendChild(select);

            // Datos reales verificados del CSV IDVFC_NM_jul25.csv (enero-julio 2025)
            const estadosData = [
                { Estado: 'Guanajuato', 'Homicidio doloso': 1761, 'Homicidio culposo': 833, 'Feminicidio': 7, 'Otros delitos que atentan contra la vida y la integridad corporal': 952, 'Total': 3553 },
                { Estado: 'Chihuahua', 'Homicidio doloso': 1069, 'Homicidio culposo': 198, 'Feminicidio': 26, 'Otros delitos que atentan contra la vida y la integridad corporal': 787, 'Total': 2080 },
                { Estado: 'Sinaloa', 'Homicidio doloso': 1063, 'Homicidio culposo': 353, 'Feminicidio': 24, 'Otros delitos que atentan contra la vida y la integridad corporal': 511, 'Total': 1951 },
                { Estado: 'Baja California', 'Homicidio doloso': 1052, 'Homicidio culposo': 262, 'Feminicidio': 16, 'Otros delitos que atentan contra la vida y la integridad corporal': 1713, 'Total': 3043 },
                { Estado: 'México', 'Homicidio doloso': 974, 'Homicidio culposo': 844, 'Feminicidio': 36, 'Otros delitos que atentan contra la vida y la integridad corporal': 967, 'Total': 2821 },
                { Estado: 'Guerrero', 'Homicidio doloso': 870, 'Homicidio culposo': 260, 'Feminicidio': 13, 'Otros delitos que atentan contra la vida y la integridad corporal': 24, 'Total': 1167 },
                { Estado: 'Michoacán de Ocampo', 'Homicidio doloso': 820, 'Homicidio culposo': 798, 'Feminicidio': 16, 'Otros delitos que atentan contra la vida y la integridad corporal': 227, 'Total': 1861 },
                { Estado: 'Jalisco', 'Homicidio doloso': 818, 'Homicidio culposo': 633, 'Feminicidio': 17, 'Otros delitos que atentan contra la vida y la integridad corporal': 79, 'Total': 1547 },
                { Estado: 'Sonora', 'Homicidio doloso': 723, 'Homicidio culposo': 112, 'Feminicidio': 8, 'Otros delitos que atentan contra la vida y la integridad corporal': 466, 'Total': 1309 },
                { Estado: 'Morelos', 'Homicidio doloso': 650, 'Homicidio culposo': 252, 'Feminicidio': 22, 'Otros delitos que atentan contra la vida y la integridad corporal': 363, 'Total': 1287 },
                { Estado: 'Veracruz de Ignacio de la Llave', 'Homicidio doloso': 540, 'Homicidio culposo': 631, 'Feminicidio': 17, 'Otros delitos que atentan contra la vida y la integridad corporal': 160, 'Total': 1348 },
                { Estado: 'Puebla', 'Homicidio doloso': 509, 'Homicidio culposo': 595, 'Feminicidio': 15, 'Otros delitos que atentan contra la vida y la integridad corporal': 167, 'Total': 1286 },
                { Estado: 'Ciudad de México', 'Homicidio doloso': 508, 'Homicidio culposo': 445, 'Feminicidio': 21, 'Otros delitos que atentan contra la vida y la integridad corporal': 706, 'Total': 1680 },
                { Estado: 'Tabasco', 'Homicidio doloso': 486, 'Homicidio culposo': 264, 'Feminicidio': 20, 'Otros delitos que atentan contra la vida y la integridad corporal': 533, 'Total': 1303 },
                { Estado: 'Oaxaca', 'Homicidio doloso': 480, 'Homicidio culposo': 817, 'Feminicidio': 11, 'Otros delitos que atentan contra la vida y la integridad corporal': 101, 'Total': 1409 },
                { Estado: 'Nuevo León', 'Homicidio doloso': 479, 'Homicidio culposo': 377, 'Feminicidio': 9, 'Otros delitos que atentan contra la vida y la integridad corporal': 221, 'Total': 1086 },
                { Estado: 'Colima', 'Homicidio doloso': 362, 'Homicidio culposo': 91, 'Feminicidio': 3, 'Otros delitos que atentan contra la vida y la integridad corporal': 0, 'Total': 456 },
                { Estado: 'Chiapas', 'Homicidio doloso': 237, 'Homicidio culposo': 514, 'Feminicidio': 17, 'Otros delitos que atentan contra la vida y la integridad corporal': 92, 'Total': 860 },
                { Estado: 'Quintana Roo', 'Homicidio doloso': 197, 'Homicidio culposo': 609, 'Feminicidio': 13, 'Otros delitos que atentan contra la vida y la integridad corporal': 235, 'Total': 1054 },
                { Estado: 'Hidalgo', 'Homicidio doloso': 178, 'Homicidio culposo': 109, 'Feminicidio': 12, 'Otros delitos que atentan contra la vida y la integridad corporal': 254, 'Total': 553 },
                { Estado: 'San Luis Potosí', 'Homicidio doloso': 160, 'Homicidio culposo': 193, 'Feminicidio': 2, 'Otros delitos que atentan contra la vida y la integridad corporal': 144, 'Total': 499 },
                { Estado: 'Tamaulipas', 'Homicidio doloso': 129, 'Homicidio culposo': 424, 'Feminicidio': 19, 'Otros delitos que atentan contra la vida y la integridad corporal': 211, 'Total': 783 },
                { Estado: 'Zacatecas', 'Homicidio doloso': 109, 'Homicidio culposo': 262, 'Feminicidio': 4, 'Otros delitos que atentan contra la vida y la integridad corporal': 175, 'Total': 550 },
                { Estado: 'Nayarit', 'Homicidio doloso': 106, 'Homicidio culposo': 176, 'Feminicidio': 7, 'Otros delitos que atentan contra la vida y la integridad corporal': 18, 'Total': 307 },
                { Estado: 'Querétaro', 'Homicidio doloso': 100, 'Homicidio culposo': 208, 'Feminicidio': 9, 'Otros delitos que atentan contra la vida y la integridad corporal': 544, 'Total': 861 },
                { Estado: 'Baja California Sur', 'Homicidio doloso': 79, 'Homicidio culposo': 72, 'Feminicidio': 3, 'Otros delitos que atentan contra la vida y la integridad corporal': 178, 'Total': 332 },
                { Estado: 'Campeche', 'Homicidio doloso': 75, 'Homicidio culposo': 58, 'Feminicidio': 6, 'Otros delitos que atentan contra la vida y la integridad corporal': 62, 'Total': 201 },
                { Estado: 'Tlaxcala', 'Homicidio doloso': 75, 'Homicidio culposo': 12, 'Feminicidio': 4, 'Otros delitos que atentan contra la vida y la integridad corporal': 0, 'Total': 91 },
                { Estado: 'Aguascalientes', 'Homicidio doloso': 67, 'Homicidio culposo': 81, 'Feminicidio': 2, 'Otros delitos que atentan contra la vida y la integridad corporal': 73, 'Total': 223 },
                { Estado: 'Coahuila de Zaragoza', 'Homicidio doloso': 42, 'Homicidio culposo': 142, 'Feminicidio': 6, 'Otros delitos que atentan contra la vida y la integridad corporal': 36, 'Total': 226 },
                { Estado: 'Durango', 'Homicidio doloso': 36, 'Homicidio culposo': 122, 'Feminicidio': 5, 'Otros delitos que atentan contra la vida y la integridad corporal': 6, 'Total': 169 },
                { Estado: 'Yucatán', 'Homicidio doloso': 15, 'Homicidio culposo': 74, 'Feminicidio': 4, 'Otros delitos que atentan contra la vida y la integridad corporal': 19, 'Total': 112 }
            ];

            // Agregar fila nacional
            const nacionalRow = {
                Estado: 'NACIONAL',
                'Homicidio doloso': 14769,
                'Homicidio culposo': 10821,
                'Feminicidio': 394,
                'Otros delitos que atentan contra la vida y la integridad corporal': 10024,
                'Total': 36008
            };

            // Función para renderizar la tabla
            const renderTable = (sortBy = 'Homicidio doloso') => {
                // Ordenar datos estatales
                const sortedData = [...estadosData].sort((a, b) => {
                    const valueA = parseInt(a[sortBy]) || 0;
                    const valueB = parseInt(b[sortBy]) || 0;
                    return valueB - valueA; // Orden descendente
                });
                
                // Combinar: Nacional primero, luego estados
                const finalData = [nacionalRow, ...sortedData];

                const table = document.createElement('table');
                table.className = 'data-table';
                
                // Orden específico de columnas para la tabla estatal
                const orderedHeaders = ['Estado', 'Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal', 'Total'];
                
                const thead = document.createElement('thead');
                const headerRow = document.createElement('tr');
                
                // Columna de ranking
                const rankTh = document.createElement('th');
                rankTh.textContent = '#';
                rankTh.style.textAlign = 'center';
                rankTh.style.backgroundColor = '#f8f9fa';
                headerRow.appendChild(rankTh);
                
                orderedHeaders.forEach(header => {
                    const th = document.createElement('th');
                    let displayName = header;
                    if (header === 'Otros delitos que atentan contra la vida y la integridad corporal') {
                        displayName = 'Otros delitos contra la vida';
                    }
                    th.textContent = displayName;
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
                table.appendChild(thead);
                
                const tbody = document.createElement('tbody');
                finalData.forEach((row, index) => {
                    const tr = document.createElement('tr');
                    
                    // Estilo especial para fila nacional
                    const isNacional = row.Estado === 'NACIONAL';
                    if (isNacional) {
                        tr.style.backgroundColor = '#e8f5e8';
                        tr.style.fontWeight = 'bold';
                        tr.style.borderTop = '2px solid #28a745';
                        tr.style.borderBottom = '2px solid #28a745';
                    }
                    
                    // Columna de ranking
                    const rankTd = document.createElement('td');
                    rankTd.textContent = isNacional ? 'NAL' : index.toString();
                    rankTd.style.textAlign = 'center';
                    rankTd.style.fontWeight = 'bold';
                    rankTd.style.backgroundColor = isNacional ? '#d4edda' : '#f8f9fa';
                    tr.appendChild(rankTd);
                    
                    orderedHeaders.forEach((header, colIndex) => {
                        const td = document.createElement('td');
                        
                        if (colIndex === 0) { // Estado
                            const estadoValue = row[header];
                            td.textContent = estadoValue;
                            td.style.textAlign = 'left';
                            td.style.fontWeight = '500';
                        } else {
                            // Números con formato de miles
                            const value = parseInt(row[header]) || 0;
                            td.textContent = value.toLocaleString();
                            td.style.textAlign = 'center';
                            
                            // Destacar la columna por la que se está ordenando
                            if (header === sortBy) {
                                td.style.backgroundColor = '#e3f2fd';
                                td.style.fontWeight = 'bold';
                            }
                        }
                        
                        tr.appendChild(td);
                    });
                    
                    // Destacar los primeros 5 estados
                    if (index < 5) {
                        tr.style.backgroundColor = index < 3 ? '#fff3cd' : '#f8f9fa';
                    }
                    
                    tbody.appendChild(tr);
                });
                table.appendChild(tbody);
                
                return table;
            };

            // Event listener para cambio de ordenamiento
            select.addEventListener('change', (e) => {
                const sortBy = e.target.value;
                const existingTable = container.querySelector('table');
                if (existingTable) {
                    existingTable.remove();
                }
                const newTable = renderTable(sortBy);
                container.appendChild(newTable);
            });

            // Limpiar contenedor y agregar controles
            container.innerHTML = '';
            container.appendChild(controlsDiv);
            
            // Renderizar tabla inicial ordenada por Homicidio doloso
            const initialTable = renderTable('Homicidio doloso');
            container.appendChild(initialTable);
        }

        // Función para crear la Gráfica 6: Composición por estado (2025)
        function createIDVFCEstatalChart() {
            const canvas = document.getElementById('chart-estatal-stacked-idvfc');
            if (!canvas) {
                return;
            }

            // Datos reales verificados del CSV IDVFC_NM_jul25.csv (enero-julio 2025)
            const estadosData = [
                { Estado: 'Guanajuato', 'Homicidio doloso': 1761, 'Homicidio culposo': 833, 'Feminicidio': 7, 'Otros delitos que atentan contra la vida y la integridad corporal': 952, 'Total': 3553 },
                { Estado: 'Chihuahua', 'Homicidio doloso': 1069, 'Homicidio culposo': 198, 'Feminicidio': 26, 'Otros delitos que atentan contra la vida y la integridad corporal': 787, 'Total': 2080 },
                { Estado: 'Sinaloa', 'Homicidio doloso': 1063, 'Homicidio culposo': 353, 'Feminicidio': 24, 'Otros delitos que atentan contra la vida y la integridad corporal': 511, 'Total': 1951 },
                { Estado: 'Baja California', 'Homicidio doloso': 1052, 'Homicidio culposo': 262, 'Feminicidio': 16, 'Otros delitos que atentan contra la vida y la integridad corporal': 1713, 'Total': 3043 },
                { Estado: 'México', 'Homicidio doloso': 974, 'Homicidio culposo': 844, 'Feminicidio': 36, 'Otros delitos que atentan contra la vida y la integridad corporal': 967, 'Total': 2821 },
                { Estado: 'Guerrero', 'Homicidio doloso': 870, 'Homicidio culposo': 260, 'Feminicidio': 13, 'Otros delitos que atentan contra la vida y la integridad corporal': 24, 'Total': 1167 },
                { Estado: 'Michoacán de Ocampo', 'Homicidio doloso': 820, 'Homicidio culposo': 798, 'Feminicidio': 16, 'Otros delitos que atentan contra la vida y la integridad corporal': 227, 'Total': 1861 },
                { Estado: 'Jalisco', 'Homicidio doloso': 818, 'Homicidio culposo': 633, 'Feminicidio': 17, 'Otros delitos que atentan contra la vida y la integridad corporal': 79, 'Total': 1547 },
                { Estado: 'Sonora', 'Homicidio doloso': 723, 'Homicidio culposo': 112, 'Feminicidio': 8, 'Otros delitos que atentan contra la vida y la integridad corporal': 466, 'Total': 1309 },
                { Estado: 'Morelos', 'Homicidio doloso': 650, 'Homicidio culposo': 252, 'Feminicidio': 22, 'Otros delitos que atentan contra la vida y la integridad corporal': 363, 'Total': 1287 },
                { Estado: 'Veracruz de Ignacio de la Llave', 'Homicidio doloso': 540, 'Homicidio culposo': 631, 'Feminicidio': 17, 'Otros delitos que atentan contra la vida y la integridad corporal': 160, 'Total': 1348 },
                { Estado: 'Puebla', 'Homicidio doloso': 509, 'Homicidio culposo': 595, 'Feminicidio': 15, 'Otros delitos que atentan contra la vida y la integridad corporal': 167, 'Total': 1286 },
                { Estado: 'Ciudad de México', 'Homicidio doloso': 508, 'Homicidio culposo': 445, 'Feminicidio': 21, 'Otros delitos que atentan contra la vida y la integridad corporal': 706, 'Total': 1680 },
                { Estado: 'Tabasco', 'Homicidio doloso': 486, 'Homicidio culposo': 264, 'Feminicidio': 20, 'Otros delitos que atentan contra la vida y la integridad corporal': 533, 'Total': 1303 },
                { Estado: 'Oaxaca', 'Homicidio doloso': 480, 'Homicidio culposo': 817, 'Feminicidio': 11, 'Otros delitos que atentan contra la vida y la integridad corporal': 101, 'Total': 1409 },
                { Estado: 'Nuevo León', 'Homicidio doloso': 479, 'Homicidio culposo': 377, 'Feminicidio': 9, 'Otros delitos que atentan contra la vida y la integridad corporal': 221, 'Total': 1086 },
                { Estado: 'Colima', 'Homicidio doloso': 362, 'Homicidio culposo': 91, 'Feminicidio': 3, 'Otros delitos que atentan contra la vida y la integridad corporal': 0, 'Total': 456 },
                { Estado: 'Chiapas', 'Homicidio doloso': 237, 'Homicidio culposo': 514, 'Feminicidio': 17, 'Otros delitos que atentan contra la vida y la integridad corporal': 92, 'Total': 860 },
                { Estado: 'Quintana Roo', 'Homicidio doloso': 197, 'Homicidio culposo': 609, 'Feminicidio': 13, 'Otros delitos que atentan contra la vida y la integridad corporal': 235, 'Total': 1054 },
                { Estado: 'Hidalgo', 'Homicidio doloso': 178, 'Homicidio culposo': 109, 'Feminicidio': 12, 'Otros delitos que atentan contra la vida y la integridad corporal': 254, 'Total': 553 },
                { Estado: 'San Luis Potosí', 'Homicidio doloso': 160, 'Homicidio culposo': 193, 'Feminicidio': 2, 'Otros delitos que atentan contra la vida y la integridad corporal': 144, 'Total': 499 },
                { Estado: 'Tamaulipas', 'Homicidio doloso': 129, 'Homicidio culposo': 424, 'Feminicidio': 19, 'Otros delitos que atentan contra la vida y la integridad corporal': 211, 'Total': 783 },
                { Estado: 'Zacatecas', 'Homicidio doloso': 109, 'Homicidio culposo': 262, 'Feminicidio': 4, 'Otros delitos que atentan contra la vida y la integridad corporal': 175, 'Total': 550 },
                { Estado: 'Nayarit', 'Homicidio doloso': 106, 'Homicidio culposo': 176, 'Feminicidio': 7, 'Otros delitos que atentan contra la vida y la integridad corporal': 18, 'Total': 307 },
                { Estado: 'Querétaro', 'Homicidio doloso': 100, 'Homicidio culposo': 208, 'Feminicidio': 9, 'Otros delitos que atentan contra la vida y la integridad corporal': 544, 'Total': 861 },
                { Estado: 'Baja California Sur', 'Homicidio doloso': 79, 'Homicidio culposo': 72, 'Feminicidio': 3, 'Otros delitos que atentan contra la vida y la integridad corporal': 178, 'Total': 332 },
                { Estado: 'Campeche', 'Homicidio doloso': 75, 'Homicidio culposo': 58, 'Feminicidio': 6, 'Otros delitos que atentan contra la vida y la integridad corporal': 62, 'Total': 201 },
                { Estado: 'Tlaxcala', 'Homicidio doloso': 75, 'Homicidio culposo': 12, 'Feminicidio': 4, 'Otros delitos que atentan contra la vida y la integridad corporal': 0, 'Total': 91 },
                { Estado: 'Aguascalientes', 'Homicidio doloso': 67, 'Homicidio culposo': 81, 'Feminicidio': 2, 'Otros delitos que atentan contra la vida y la integridad corporal': 73, 'Total': 223 },
                { Estado: 'Coahuila de Zaragoza', 'Homicidio doloso': 42, 'Homicidio culposo': 142, 'Feminicidio': 6, 'Otros delitos que atentan contra la vida y la integridad corporal': 36, 'Total': 226 },
                { Estado: 'Durango', 'Homicidio doloso': 36, 'Homicidio culposo': 122, 'Feminicidio': 5, 'Otros delitos que atentan contra la vida y la integridad corporal': 6, 'Total': 169 },
                { Estado: 'Yucatán', 'Homicidio doloso': 15, 'Homicidio culposo': 74, 'Feminicidio': 4, 'Otros delitos que atentan contra la vida y la integridad corporal': 19, 'Total': 112 }
            ];

            // Ordenar estados por violencia homicida total de mayor a menor
            estadosData.sort((a, b) => b.Total - a.Total);

            const estados = estadosData.map(e => e.Estado);
            
            // Colores consistentes con la gráfica nacional
            const colors = [
                'rgba(231, 76, 60, 0.8)',   // Rojo para Homicidio doloso
                'rgba(52, 152, 219, 0.8)',   // Azul para Homicidio culposo
                'rgba(155, 89, 182, 0.8)',   // Púrpura para Feminicidio
                'rgba(46, 204, 113, 0.8)'    // Verde para Otros delitos
            ];
            
            const datasets = [
                {
                    label: 'Homicidio doloso',
                    data: estadosData.map(e => parseInt(e['Homicidio doloso']) || 0),
                    backgroundColor: colors[0],
                    borderColor: colors[0].replace('0.8', '1'),
                    borderWidth: 1
                },
                {
                    label: 'Homicidio culposo',
                    data: estadosData.map(e => parseInt(e['Homicidio culposo']) || 0),
                    backgroundColor: colors[1],
                    borderColor: colors[1].replace('0.8', '1'),
                    borderWidth: 1
                },
                {
                    label: 'Feminicidio',
                    data: estadosData.map(e => parseInt(e.Feminicidio) || 0),
                    backgroundColor: colors[2],
                    borderColor: colors[2].replace('0.8', '1'),
                    borderWidth: 1
                },
                {
                    label: 'Otros delitos contra la vida',
                    data: estadosData.map(e => parseInt(e['Otros delitos que atentan contra la vida y la integridad corporal']) || 0),
                    backgroundColor: colors[3],
                    borderColor: colors[3].replace('0.8', '1'),
                    borderWidth: 1
                }
            ];

            // Destruir gráfico existente si existe
            if (window.idvfcEstatalStackedChart) {
                window.idvfcEstatalStackedChart.destroy();
            }

            const ctx = canvas.getContext('2d');
            window.idvfcEstatalStackedChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: estados,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 15
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed.y;
                                    const total = context.chart.data.datasets.reduce((sum, dataset) => {
                                        return sum + dataset.data[context.dataIndex];
                                    }, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${context.dataset.label}: ${value.toLocaleString()} (${percentage}%)`;
                                },
                                footer: function(tooltipItems) {
                                    if (tooltipItems.length > 0) {
                                        const total = tooltipItems.reduce((sum, item) => sum + item.parsed.y, 0);
                                        return `Total: ${total.toLocaleString()} casos`;
                                    }
                                    return '';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            title: {
                                display: true,
                                text: 'Estados'
                            },
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        },
                        y: {
                            stacked: true,
                            title: {
                                display: true,
                                text: 'Número de casos'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    }
                }
            });
        }

        // Función para crear Tabla 7: Ranking mensual estatal (Top 10)
        function createIDVFCRankingMensualTable() {
            const container = document.getElementById('ranking-tables-grid-idvfc');
            if (!container) {
                return;
            }

            // Generar tablas mensuales para los 19 meses completos (enero 2024 a julio 2025)
            const meses = [
                'Enero 2024', 'Febrero 2024', 'Marzo 2024', 'Abril 2024', 'Mayo 2024', 'Junio 2024', 'Julio 2024',
                'Agosto 2024', 'Septiembre 2024', 'Octubre 2024', 'Noviembre 2024', 'Diciembre 2024',
                'Enero 2025', 'Febrero 2025', 'Marzo 2025', 'Abril 2025', 'Mayo 2025', 'Junio 2025', 'Julio 2025'
            ];

            meses.forEach(mes => {
                // Crear contenedor de tabla con formato exacto de la sección nacional
                const tableContainer = document.createElement('div');
                tableContainer.className = 'ranking-table-container';

                // Título de la tabla
                const title = document.createElement('div');
                title.className = 'ranking-table-title';
                title.textContent = mes;
                tableContainer.appendChild(title);

                // Crear tabla
                const table = document.createElement('table');
                table.className = 'ranking-mini-table';

                // Header
                const thead = document.createElement('thead');
                const headerRow = document.createElement('tr');
                
                const headers = ['#', 'Estado', 'Casos'];
                headers.forEach(headerText => {
                    const th = document.createElement('th');
                    th.textContent = headerText;
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
                table.appendChild(thead);

                // Body
                const tbody = document.createElement('tbody');
                tbody.innerHTML = '<tr><td colspan="3">Datos cargando...</td></tr>';
                table.appendChild(tbody);
                
                tableContainer.appendChild(table);
                container.appendChild(tableContainer);
            });

            // Función para abreviar nombres de estados
            function abbreviateStateName(fullName) {
                if (!fullName || typeof fullName !== 'string') {
                    return 'N/A';
                }
                
                const abbreviations = {
                    'Aguascalientes': 'AGS',
                    'Baja California': 'BC',
                    'Baja California Sur': 'BCS',
                    'Campeche': 'CAM',
                    'Coahuila de Zaragoza': 'COAH',
                    'Colima': 'COL',
                    'Chiapas': 'CHIS',
                    'Chihuahua': 'CHIH',
                    'Ciudad de México': 'CDMX',
                    'Durango': 'DGO',
                    'Guanajuato': 'GTO',
                    'Guerrero': 'GRO',
                    'Hidalgo': 'HGO',
                    'Jalisco': 'JAL',
                    'México': 'MEX',
                    'Michoacán de Ocampo': 'MICH',
                    'Morelos': 'MOR',
                    'Nayarit': 'NAY',
                    'Nuevo León': 'NL',
                    'Oaxaca': 'OAX',
                    'Puebla': 'PUE',
                    'Querétaro': 'QRO',
                    'Quintana Roo': 'QROO',
                    'San Luis Potosí': 'SLP',
                    'Sinaloa': 'SIN',
                    'Sonora': 'SON',
                    'Tabasco': 'TAB',
                    'Tamaulipas': 'TAMS',
                    'Tlaxcala': 'TLAX',
                    'Veracruz de Ignacio de la Llave': 'VER',
                    'Yucatán': 'YUC',
                    'Zacatecas': 'ZAC'
                };
                
                return abbreviations[fullName] || fullName.substring(0, 4).toUpperCase();
            }

            // Event listener para el selector de tipo de violencia
            const selector = document.getElementById('violence-type-selector-idvfc');
            if (selector) {
                selector.addEventListener('change', function() {
                    updateAllRankingTables(this.value);
                });
            }

            // Función para actualizar todas las tablas
            function updateAllRankingTables(tipoViolencia) {
                // Obtener todas las tablas mensuales
                const monthContainers = document.querySelectorAll('#ranking-tables-grid-idvfc .ranking-table-container');
                
                monthContainers.forEach(container => {
                    const monthTitle = container.querySelector('.ranking-table-title').textContent;
                    const table = container.querySelector('table tbody');
                    
                    if (rankingMensualData[monthTitle] && rankingMensualData[monthTitle][tipoViolencia]) {
                        // Limpiar tabla
                        table.innerHTML = '';
                        
                        // Obtener datos para este mes y tipo de violencia
                        const monthData = rankingMensualData[monthTitle][tipoViolencia];
                        
                        // Crear filas de datos
                        monthData.forEach((estadoData, index) => {
                            const tr = document.createElement('tr');
                            
                            // Destacar Sinaloa en amarillo
                            if (estadoData.Estado === 'Sinaloa') {
                                tr.style.backgroundColor = '#fff3cd';
                                tr.style.fontWeight = 'bold';
                            }
                            
                            // Ranking
                            const rankTd = document.createElement('td');
                            rankTd.className = 'rank-cell';
                            rankTd.textContent = (index + 1).toString();
                            tr.appendChild(rankTd);
                            
                            // Estado (abreviado con tooltip)
                            const stateTd = document.createElement('td');
                            stateTd.className = 'state-cell';
                            stateTd.textContent = abbreviateStateName(estadoData.Estado);
                            stateTd.title = estadoData.Estado; // Tooltip con nombre completo
                            tr.appendChild(stateTd);
                            
                            // Valor
                            const valueTd = document.createElement('td');
                            valueTd.className = 'value-cell';
                            valueTd.textContent = estadoData.Valor.toLocaleString();
                            tr.appendChild(valueTd);
                            
                            table.appendChild(tr);
                        });
                    } else {
                        // Si no hay datos para este tipo de violencia, mostrar mensaje
                        table.innerHTML = '<tr><td colspan="3" style="text-align: center; color: #666;">Datos no disponibles para este tipo de violencia</td></tr>';
                    }
                });
            }

            // Inicializar con Homicidio doloso por defecto
            updateAllRankingTables('Homicidio doloso');
        }

        // ✅ DATOS COMPLETOS: CSV IDVFC_NM_jul25.csv - TODOS los 19 meses verificados
        // Datos extraídos automáticamente del CSV para enero 2024 - julio 2025
        // Incluye Top 10 para Homicidio doloso, Homicidio culposo, Feminicidio, 
        // Otros delitos que atentan contra la vida y la integridad corporal, y Total

        // Datos de población por estado para 2025 (desde poblacion_estados_2018_2025.csv)
        const idvfcPoblacionEstados2025 = {
            'Aguascalientes': 1549118,
            'Baja California': 4131619,
            'Baja California Sur': 904052,
            'Campeche': 958567,
            'Coahuila de Zaragoza': 3400257,
            'Colima': 767105,
            'Chiapas': 6107903,
            'Chihuahua': 4043130,
            'Ciudad de México': 9183658,
            'Durango': 1927128,
            'Guanajuato': 6537669,
            'Guerrero': 3607434,
            'Hidalgo': 3299857,
            'Jalisco': 8903326,
            'México': 17723173,
            'Michoacán de Ocampo': 5045030,
            'Morelos': 2056103,
            'Nayarit': 1324282,
            'Nuevo León': 6413123,
            'Oaxaca': 4339377,
            'Puebla': 7070124,
            'Querétaro': 2654421,
            'Quintana Roo': 2101638,
            'San Luis Potosí': 2979775,
            'Sinaloa': 3187466,
            'Sonora': 3140762,
            'Tabasco': 2467519,
            'Tamaulipas': 3748419,
            'Tlaxcala': 1447721,
            'Veracruz de Ignacio de la Llave': 8121275,
            'Yucatán': 2513461,
            'Zacatecas': 1712936
        };

        // Función para crear la Tabla 8: Tasas de violencia homicida a nivel estatal (2025)
        function createIDVFCEstatalRatesTable() {
            const container = document.getElementById('tabla-estatal-rates-idvfc-2025');
            if (!container) {
                return;
            }

            // ✅ DATOS CORRECTOS: CSV IDVFC_NM_jul25.csv - AÑO 2025 ÚNICAMENTE
            // Filtrado por: Año = 2025, Entidad, Subtipo de delito (4 subtipos de violencia homicida)
            // Suma de columnas de meses enero-julio 2025 por cada entidad y subtipo
            const estadosData = [
                { Estado: 'Aguascalientes', 'Homicidio doloso': 67, 'Homicidio culposo': 81, 'Feminicidio': 2, 'Otros delitos que atentan contra la vida y la integridad corporal': 73, 'Total': 223 },
                { Estado: 'Baja California', 'Homicidio doloso': 1052, 'Homicidio culposo': 262, 'Feminicidio': 16, 'Otros delitos que atentan contra la vida y la integridad corporal': 1713, 'Total': 3043 },
                { Estado: 'Baja California Sur', 'Homicidio doloso': 79, 'Homicidio culposo': 72, 'Feminicidio': 3, 'Otros delitos que atentan contra la vida y la integridad corporal': 178, 'Total': 332 },
                { Estado: 'Campeche', 'Homicidio doloso': 75, 'Homicidio culposo': 58, 'Feminicidio': 6, 'Otros delitos que atentan contra la vida y la integridad corporal': 62, 'Total': 201 },
                { Estado: 'Chiapas', 'Homicidio doloso': 237, 'Homicidio culposo': 514, 'Feminicidio': 17, 'Otros delitos que atentan contra la vida y la integridad corporal': 92, 'Total': 860 },
                { Estado: 'Chihuahua', 'Homicidio doloso': 1069, 'Homicidio culposo': 198, 'Feminicidio': 26, 'Otros delitos que atentan contra la vida y la integridad corporal': 787, 'Total': 2080 },
                { Estado: 'Ciudad de México', 'Homicidio doloso': 508, 'Homicidio culposo': 445, 'Feminicidio': 21, 'Otros delitos que atentan contra la vida y la integridad corporal': 706, 'Total': 1680 },
                { Estado: 'Coahuila de Zaragoza', 'Homicidio doloso': 42, 'Homicidio culposo': 142, 'Feminicidio': 6, 'Otros delitos que atentan contra la vida y la integridad corporal': 36, 'Total': 226 },
                { Estado: 'Colima', 'Homicidio doloso': 362, 'Homicidio culposo': 91, 'Feminicidio': 3, 'Otros delitos que atentan contra la vida y la integridad corporal': 0, 'Total': 456 },
                { Estado: 'Durango', 'Homicidio doloso': 36, 'Homicidio culposo': 122, 'Feminicidio': 5, 'Otros delitos que atentan contra la vida y la integridad corporal': 6, 'Total': 169 },
                { Estado: 'Guanajuato', 'Homicidio doloso': 1761, 'Homicidio culposo': 833, 'Feminicidio': 7, 'Otros delitos que atentan contra la vida y la integridad corporal': 952, 'Total': 3553 },
                { Estado: 'Guerrero', 'Homicidio doloso': 870, 'Homicidio culposo': 260, 'Feminicidio': 13, 'Otros delitos que atentan contra la vida y la integridad corporal': 24, 'Total': 1167 },
                { Estado: 'Hidalgo', 'Homicidio doloso': 178, 'Homicidio culposo': 109, 'Feminicidio': 12, 'Otros delitos que atentan contra la vida y la integridad corporal': 254, 'Total': 553 },
                { Estado: 'Jalisco', 'Homicidio doloso': 818, 'Homicidio culposo': 633, 'Feminicidio': 17, 'Otros delitos que atentan contra la vida y la integridad corporal': 79, 'Total': 1547 },
                { Estado: 'México', 'Homicidio doloso': 974, 'Homicidio culposo': 844, 'Feminicidio': 36, 'Otros delitos que atentan contra la vida y la integridad corporal': 967, 'Total': 2821 },
                { Estado: 'Michoacán de Ocampo', 'Homicidio doloso': 820, 'Homicidio culposo': 798, 'Feminicidio': 16, 'Otros delitos que atentan contra la vida y la integridad corporal': 227, 'Total': 1861 },
                { Estado: 'Morelos', 'Homicidio doloso': 650, 'Homicidio culposo': 252, 'Feminicidio': 22, 'Otros delitos que atentan contra la vida y la integridad corporal': 363, 'Total': 1287 },
                { Estado: 'Nayarit', 'Homicidio doloso': 106, 'Homicidio culposo': 176, 'Feminicidio': 7, 'Otros delitos que atentan contra la vida y la integridad corporal': 18, 'Total': 307 },
                { Estado: 'Nuevo León', 'Homicidio doloso': 479, 'Homicidio culposo': 377, 'Feminicidio': 9, 'Otros delitos que atentan contra la vida y la integridad corporal': 221, 'Total': 1086 },
                { Estado: 'Oaxaca', 'Homicidio doloso': 480, 'Homicidio culposo': 817, 'Feminicidio': 11, 'Otros delitos que atentan contra la vida y la integridad corporal': 101, 'Total': 1409 },
                { Estado: 'Puebla', 'Homicidio doloso': 509, 'Homicidio culposo': 595, 'Feminicidio': 15, 'Otros delitos que atentan contra la vida y la integridad corporal': 167, 'Total': 1286 },
                { Estado: 'Querétaro', 'Homicidio doloso': 100, 'Homicidio culposo': 208, 'Feminicidio': 9, 'Otros delitos que atentan contra la vida y la integridad corporal': 544, 'Total': 861 },
                { Estado: 'Quintana Roo', 'Homicidio doloso': 197, 'Homicidio culposo': 609, 'Feminicidio': 13, 'Otros delitos que atentan contra la vida y la integridad corporal': 235, 'Total': 1054 },
                { Estado: 'San Luis Potosí', 'Homicidio doloso': 160, 'Homicidio culposo': 193, 'Feminicidio': 2, 'Otros delitos que atentan contra la vida y la integridad corporal': 144, 'Total': 499 },
                { Estado: 'Sinaloa', 'Homicidio doloso': 1063, 'Homicidio culposo': 353, 'Feminicidio': 24, 'Otros delitos que atentan contra la vida y la integridad corporal': 511, 'Total': 1951 },
                { Estado: 'Sonora', 'Homicidio doloso': 723, 'Homicidio culposo': 112, 'Feminicidio': 8, 'Otros delitos que atentan contra la vida y la integridad corporal': 466, 'Total': 1309 },
                { Estado: 'Tabasco', 'Homicidio doloso': 486, 'Homicidio culposo': 264, 'Feminicidio': 20, 'Otros delitos que atentan contra la vida y la integridad corporal': 533, 'Total': 1303 },
                { Estado: 'Tamaulipas', 'Homicidio doloso': 129, 'Homicidio culposo': 424, 'Feminicidio': 19, 'Otros delitos que atentan contra la vida y la integridad corporal': 211, 'Total': 783 },
                { Estado: 'Tlaxcala', 'Homicidio doloso': 75, 'Homicidio culposo': 12, 'Feminicidio': 4, 'Otros delitos que atentan contra la vida y la integridad corporal': 0, 'Total': 91 },
                { Estado: 'Veracruz de Ignacio de la Llave', 'Homicidio doloso': 540, 'Homicidio culposo': 631, 'Feminicidio': 17, 'Otros delitos que atentan contra la vida y la integridad corporal': 160, 'Total': 1348 },
                { Estado: 'Yucatán', 'Homicidio doloso': 15, 'Homicidio culposo': 74, 'Feminicidio': 4, 'Otros delitos que atentan contra la vida y la integridad corporal': 19, 'Total': 112 },
                { Estado: 'Zacatecas', 'Homicidio doloso': 109, 'Homicidio culposo': 262, 'Feminicidio': 4, 'Otros delitos que atentan contra la vida y la integridad corporal': 175, 'Total': 550 }
            ];

            // Convertir datos a tasas por 100,000 habitantes
            const ratesData = estadosData.map(row => {
                const nombreEstado = row.Estado;
                const poblacion = idvfcPoblacionEstados2025[nombreEstado];
                
                if (!poblacion) {
                    console.warn('⚠️ No se encontró población para:', nombreEstado);
                }
                
                const rateRow = { ...row };
                
                if (poblacion && poblacion > 0) {
                    rateRow['Homicidio doloso'] = (row['Homicidio doloso'] / poblacion) * 100000;
                    rateRow['Homicidio culposo'] = (row['Homicidio culposo'] / poblacion) * 100000;
                    rateRow['Feminicidio'] = (row['Feminicidio'] / poblacion) * 100000;
                    rateRow['Otros delitos que atentan contra la vida y la integridad corporal'] = (row['Otros delitos que atentan contra la vida y la integridad corporal'] / poblacion) * 100000;
                    rateRow['Total'] = (row['Total'] / poblacion) * 100000;
                } else {
                    rateRow['Homicidio doloso'] = 0;
                    rateRow['Homicidio culposo'] = 0;
                    rateRow['Feminicidio'] = 0;
                    rateRow['Otros delitos que atentan contra la vida y la integridad corporal'] = 0;
                    rateRow['Total'] = 0;
                }
                
                return rateRow;
            });

            // Calcular datos nacionales
            const nacionalTotals = {
                'Homicidio doloso': 14769,
                'Homicidio culposo': 10821,
                'Feminicidio': 394,
                'Otros delitos que atentan contra la vida y la integridad corporal': 10024,
                'Total': 36008
            };
            
            const poblacionNacional2025 = 133367428;
            const nacionalRates = {
                Estado: 'NACIONAL',
                'Homicidio doloso': (nacionalTotals['Homicidio doloso'] / poblacionNacional2025) * 100000,
                'Homicidio culposo': (nacionalTotals['Homicidio culposo'] / poblacionNacional2025) * 100000,
                'Feminicidio': (nacionalTotals['Feminicidio'] / poblacionNacional2025) * 100000,
                'Otros delitos que atentan contra la vida y la integridad corporal': (nacionalTotals['Otros delitos que atentan contra la vida y la integridad corporal'] / poblacionNacional2025) * 100000,
                'Total': (nacionalTotals['Total'] / poblacionNacional2025) * 100000
            };

            // Agregar datos nacionales al inicio
            ratesData.unshift(nacionalRates);
            
            // Ordenar estados (excluyendo nacional que ya está al inicio)
            const estadosDataSorted = ratesData.slice(1);
            estadosDataSorted.sort((a, b) => b.Total - a.Total);
            
            // Recombinar: Nacional primero, luego estados ordenados
            const finalData = [ratesData[0], ...estadosDataSorted];

            // Crear controles de ordenamiento
            const controlsDiv = document.createElement('div');
            controlsDiv.className = 'table-controls';
            controlsDiv.style.marginBottom = '15px';
            controlsDiv.style.padding = '10px';
            controlsDiv.style.backgroundColor = '#f8f9fa';
            controlsDiv.style.borderRadius = '5px';
            controlsDiv.style.border = '1px solid #dee2e6';

            const label = document.createElement('label');
            label.textContent = 'Ordenar por: ';
            label.style.fontWeight = 'bold';
            label.style.marginRight = '10px';

            const select = document.createElement('select');
            select.id = 'sort-select-rates-idvfc';
            select.style.padding = '5px 10px';
            select.style.borderRadius = '3px';
            select.style.border = '1px solid #ccc';
            select.style.fontSize = '14px';

            // Opciones de ordenamiento
            const sortOptions = [
                { value: 'Total', text: 'Violencia homicida total' },
                { value: 'Homicidio doloso', text: 'Homicidios dolosos' },
                { value: 'Homicidio culposo', text: 'Homicidios culposos' },
                { value: 'Feminicidio', text: 'Feminicidios' },
                { value: 'Otros delitos que atentan contra la vida y la integridad corporal', text: 'Otros delitos contra la vida' }
            ];

            sortOptions.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option.value;
                optionElement.textContent = option.text;
                if (option.value === 'Total') {
                    optionElement.selected = true;
                }
                select.appendChild(optionElement);
            });

            controlsDiv.appendChild(label);
            controlsDiv.appendChild(select);

            // Función para renderizar la tabla
            const renderTable = (sortBy = 'Total') => {
                const sortedData = [...finalData].sort((a, b) => {
                    const valueA = parseFloat(a[sortBy]) || 0;
                    const valueB = parseFloat(b[sortBy]) || 0;
                    return valueB - valueA;
                });

                const table = document.createElement('table');
                table.className = 'data-table';
                
                const orderedHeaders = ['Entidad', 'Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal', 'Total'];
                
                const thead = document.createElement('thead');
                const headerRow = document.createElement('tr');
                
                const rankTh = document.createElement('th');
                rankTh.textContent = '#';
                rankTh.style.width = '40px';
                headerRow.appendChild(rankTh);
                
                orderedHeaders.forEach(header => {
                    const th = document.createElement('th');
                    let displayName = header;
                    if (header === 'Otros delitos que atentan contra la vida y la integridad corporal') {
                        displayName = 'Otros delitos contra la vida';
                    } else if (header === 'Total') {
                        displayName = 'Violencia homicida total';
                    }
                    th.textContent = displayName;
                    
                    if (header === sortBy) {
                        th.style.backgroundColor = '#007bff';
                        th.style.color = 'white';
                        th.style.fontWeight = 'bold';
                    }
                    
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
                table.appendChild(thead);
                
                const tbody = document.createElement('tbody');
                sortedData.forEach((row, index) => {
                    const tr = document.createElement('tr');
                    
                    const isNacional = row.Estado === 'NACIONAL';
                    if (isNacional) {
                        tr.style.backgroundColor = '#e8f5e8';
                        tr.style.fontWeight = 'bold';
                        tr.style.borderTop = '2px solid #28a745';
                        tr.style.borderBottom = '2px solid #28a745';
                    }
                    
                    const rankTd = document.createElement('td');
                    rankTd.textContent = isNacional ? 'NAL' : (index + 1).toString();
                    rankTd.style.textAlign = 'center';
                    rankTd.style.fontWeight = 'bold';
                    rankTd.style.backgroundColor = isNacional ? '#d4edda' : '#f8f9fa';
                    tr.appendChild(rankTd);
                    
                    orderedHeaders.forEach((header, colIndex) => {
                        const td = document.createElement('td');
                        
                        if (colIndex === 0) {
                            const entidadValue = row[header] || row.Estado;
                            td.textContent = entidadValue || 'N/A';
                            td.style.textAlign = 'left';
                            td.style.fontWeight = '500';
                        } else {
                            const rate = parseFloat(row[header]) || 0;
                            td.textContent = rate.toFixed(2);
                            td.style.textAlign = 'center';
                            
                            if (header === sortBy) {
                                td.style.backgroundColor = '#e3f2fd';
                                td.style.fontWeight = 'bold';
                            }
                        }
                        
                        tr.appendChild(td);
                    });
                    
                    if (!isNacional && index < 5) {
                        tr.style.backgroundColor = index < 3 ? '#fff3cd' : '#f8f9fa';
                    }
                    
                    tbody.appendChild(tr);
                });
                table.appendChild(tbody);
                
                return table;
            };

            select.addEventListener('change', (e) => {
                const sortBy = e.target.value;
                const existingTable = container.querySelector('table');
                if (existingTable) {
                    existingTable.remove();
                }
                const newTable = renderTable(sortBy);
                container.insertBefore(newTable, container.querySelector('.source-note'));
                
                const sourceNote = container.querySelector('.source-note');
                const sortText = sortOptions.find(opt => opt.value === sortBy).text.toLowerCase();
                sourceNote.innerHTML = `<strong>Fuente:</strong> SESNSP, INEGI y CONAPO. Tasas por cada 100,000 habitantes calculadas con datos de población 2025. Estados ordenados por ${sortText} de mayor a menor (enero-julio 2025).`;
            });

            const sourceNote = document.createElement('p');
            sourceNote.className = 'source-note';
            sourceNote.style.fontSize = '12px';
            sourceNote.style.fontStyle = 'italic';
            sourceNote.style.marginTop = '10px';
            sourceNote.style.color = '#666';
            sourceNote.innerHTML = '<strong>Fuente:</strong> SESNSP, INEGI y CONAPO. Tasas por cada 100,000 habitantes calculadas con datos de población 2025. Estados ordenados por violencia homicida total de mayor a menor (enero-julio 2025).';
            
            const initialTable = renderTable('Total');
            
            container.innerHTML = '';
            container.appendChild(controlsDiv);
            container.appendChild(initialTable);
            container.appendChild(sourceNote);
        }

        // Función para crear la Tabla 11: Violencia homicida en Sinaloa por tipo de delito (2019-2025)
        function createIDVFCSinaloaAnualTable() {
            const container = document.getElementById('tabla-sinaloa-idvfc');
            if (!container) {
                return;
            }

            // ✅ DATOS CORRECTOS: CSV IDVFC_NM_jul25.csv - SINALOA 2019-2025 (ENERO-JULIO)
            const años = [2019, 2020, 2021, 2022, 2023, 2024, 2025];
            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            // Datos reales extraídos del CSV IDVFC_NM_jul25.csv
            const sinaloaData = {
                'Homicidio doloso': [496, 480, 355, 285, 321, 294, 1063],
                'Homicidio culposo': [342, 380, 425, 428, 428, 445, 353],
                'Feminicidio': [25, 15, 25, 11, 16, 13, 24],
                'Otros delitos que atentan contra la vida y la integridad corporal': [489, 328, 369, 400, 431, 448, 511]
            };

            // Calcular totales por año
            const totales = años.map((año, index) => {
                return sinaloaData['Homicidio doloso'][index] + 
                       sinaloaData['Homicidio culposo'][index] + 
                       sinaloaData['Feminicidio'][index] + 
                       sinaloaData['Otros delitos que atentan contra la vida y la integridad corporal'][index];
            });

            const table = document.createElement('table');
            table.className = 'data-table';
            
            // Headers
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            
            const headers = ['Año', 'Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos contra la vida', 'Violencia homicida total'];
            
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            // Body - crear fila por cada año
            const tbody = document.createElement('tbody');
            años.forEach((año, index) => {
                const tr = document.createElement('tr');
                
                // Año
                const yearTd = document.createElement('td');
                yearTd.textContent = año;
                yearTd.style.textAlign = 'left';
                yearTd.style.fontWeight = '500';
                tr.appendChild(yearTd);
                
                // Homicidio doloso
                const hdTd = document.createElement('td');
                const hdValue = sinaloaData['Homicidio doloso'][index];
                hdTd.textContent = hdValue.toLocaleString();
                hdTd.style.textAlign = 'center';
                tr.appendChild(hdTd);
                
                // Homicidio culposo
                const hcTd = document.createElement('td');
                const hcValue = sinaloaData['Homicidio culposo'][index];
                hcTd.textContent = hcValue.toLocaleString();
                hcTd.style.textAlign = 'center';
                tr.appendChild(hcTd);
                
                // Feminicidio
                const femTd = document.createElement('td');
                const femValue = sinaloaData['Feminicidio'][index];
                femTd.textContent = femValue.toLocaleString();
                femTd.style.textAlign = 'center';
                tr.appendChild(femTd);
                
                // Otros delitos
                const otrosTd = document.createElement('td');
                const otrosValue = sinaloaData['Otros delitos que atentan contra la vida y la integridad corporal'][index];
                otrosTd.textContent = otrosValue.toLocaleString();
                otrosTd.style.textAlign = 'center';
                tr.appendChild(otrosTd);
                
                // Total
                const totalTd = document.createElement('td');
                const totalValue = totales[index];
                totalTd.textContent = totalValue.toLocaleString();
                totalTd.style.textAlign = 'center';
                tr.appendChild(totalTd);
                
                // Destacar la última fila (año más reciente - 2025)
                if (index === años.length - 1) {
                    tr.style.backgroundColor = '#34495e';
                    tr.style.color = 'white';
                    tr.style.fontWeight = 'bold';
                }
                
                tbody.appendChild(tr);
            });
            table.appendChild(tbody);
            
            // Agregar nota de fuente
            const sourceNote = document.createElement('p');
            sourceNote.className = 'source-note';
            sourceNote.style.fontSize = '12px';
            sourceNote.style.fontStyle = 'italic';
            sourceNote.style.marginTop = '10px';
            sourceNote.style.color = '#666';
            sourceNote.innerHTML = '<strong>Fuente:</strong> SESNSP. Datos anuales de violencia homicida en Sinaloa (enero-julio).';
            
            container.innerHTML = '';
            container.appendChild(table);
            container.appendChild(sourceNote);
        }

        // Función para crear la Gráfica 9: Evolución de la violencia homicida en Sinaloa (2019-2025)
        function createIDVFCSinaloaAnualChart() {
            const canvas = document.getElementById('chart-sinaloa-anual-idvfc');
            if (!canvas) {
                return;
            }

            // ✅ DATOS CORRECTOS: CSV IDVFC_NM_jul25.csv - SINALOA 2019-2025 (ENERO-JULIO)
            const años = [2019, 2020, 2021, 2022, 2023, 2024, 2025];
            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            // Datos reales extraídos del CSV IDVFC_NM_jul25.csv
            const sinaloaData = {
                'Homicidio doloso': [496, 480, 355, 285, 321, 294, 1063],
                'Homicidio culposo': [342, 380, 425, 428, 428, 445, 353],
                'Feminicidio': [25, 15, 25, 11, 16, 13, 24],
                'Otros delitos que atentan contra la vida y la integridad corporal': [489, 328, 369, 400, 431, 448, 511]
            };

            // Calcular totales por año
            const totales = años.map((año, index) => {
                return sinaloaData['Homicidio doloso'][index] + 
                       sinaloaData['Homicidio culposo'][index] + 
                       sinaloaData['Feminicidio'][index] + 
                       sinaloaData['Otros delitos que atentan contra la vida y la integridad corporal'][index];
            });

            const datasets = [];
            
            delitos.forEach((delito, index) => {
                const colors = ['#2ecc71', '#e74c3c', '#3498db', '#f39c12'];
                datasets.push({
                    label: delito === 'Otros delitos que atentan contra la vida y la integridad corporal' ? 'Otros delitos contra la vida' : delito,
                    data: sinaloaData[delito],
                    type: 'line',
                    borderColor: colors[index],
                    backgroundColor: colors[index],
                    borderWidth: 3,
                    fill: false,
                    tension: 0,
                    pointRadius: 0,
                    pointHoverRadius: 6,
                    order: index + 1
                });
            });
            
            datasets.push({
                label: 'Violencia homicida',
                data: totales,
                type: 'bar',
                backgroundColor: '#34495e',
                borderColor: '#34495e',
                borderWidth: 1,
                order: 5
            });

            // Destruir gráfico existente si existe
            if (window.idvfcSinaloaAnualChart) {
                window.idvfcSinaloaAnualChart.destroy();
            }

            const ctx = canvas.getContext('2d');
            window.idvfcSinaloaAnualChart = new Chart(ctx, {
                type: 'bar',
                data: { labels: años, datasets: datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: false
                        },
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Año'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Casos'
                            },
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Función para actualizar la Gráfica 10 según el subtipo seleccionado
        function updateIDVFCSinaloaMensualChart(subtipoSeleccionado) {
            const canvas = document.getElementById('chart-grafica-10-sinaloa-idvfc');
            if (!canvas) {
                return;
            }

            // ✅ DATOS CORRECTOS: CSV IDVFC_NM_jul25.csv - SINALOA 2024-2025 (ENERO-JULIO)
            const labels = [
                'Enero 2024', 'Febrero 2024', 'Marzo 2024', 'Abril 2024', 'Mayo 2024', 'Junio 2024', 'Julio 2024', 'Agosto 2024',
                'Septiembre 2024', 'Octubre 2024', 'Noviembre 2024', 'Diciembre 2024',
                'Enero 2025', 'Febrero 2025', 'Marzo 2025', 'Abril 2025', 'Mayo 2025', 'Junio 2025', 'Julio 2025'
            ];
            
            // Datos reales extraídos del CSV IDVFC_NM_jul25.csv
            const sinaloaMensualData = {
                'Homicidio doloso': [52, 38, 34, 33, 42, 45, 50, 44, 143, 182, 174, 157, 147, 120, 135, 119, 165, 207, 170],
                'Homicidio culposo': [60, 55, 80, 65, 67, 58, 60, 43, 41, 51, 34, 43, 47, 57, 49, 54, 49, 50, 47],
                'Feminicidio': [1, 3, 1, 1, 2, 1, 4, 1, 1, 6, 2, 5, 0, 5, 2, 6, 2, 5, 4],
                'Otros delitos que atentan contra la vida y la integridad corporal': [64, 52, 58, 58, 77, 66, 73, 70, 59, 81, 54, 69, 50, 70, 83, 76, 83, 100, 49],
                'Total': [177, 148, 173, 157, 188, 170, 187, 158, 244, 320, 264, 274, 244, 252, 269, 255, 299, 362, 270]
            };

            // Destruir gráfico existente si existe
            if (window.idvfcGrafica10Chart) {
                window.idvfcGrafica10Chart.destroy();
            }

            // Obtener datos del subtipo seleccionado
            const datos = sinaloaMensualData[subtipoSeleccionado];
            if (!datos) {
                console.error('Subtipo no encontrado:', subtipoSeleccionado);
                return;
            }

            // Configurar colores según el subtipo
            const colores = {
                'Homicidio doloso': '#e74c3c',
                'Homicidio culposo': '#2ecc71',
                'Feminicidio': '#3498db',
                'Otros delitos que atentan contra la vida y la integridad corporal': '#f39c12',
                'Total': '#34495e'
            };

            const ctx = canvas.getContext('2d');
            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: subtipoSeleccionado === 'Otros delitos que atentan contra la vida y la integridad corporal' ? 
                                   'Otros delitos contra la vida' : subtipoSeleccionado,
                            data: datos,
                            borderColor: colores[subtipoSeleccionado],
                            backgroundColor: colores[subtipoSeleccionado] + '20',
                            tension: 0.1,
                            borderWidth: 3,
                            fill: false,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Gráfica 10. Evolución mensual de la violencia homicida en Sinaloa (2024-2025)',
                            font: { size: 16, weight: 'bold' }
                        },
                        subtitle: {
                            display: false
                        },
                        legend: {
                            display: true,
                            position: 'bottom'
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                title: function(context) {
                                    return 'Mes: ' + context[0].label;
                                },
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toLocaleString() + ' casos';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Período (Enero 2024 - Julio 2025)'
                            },
                            grid: {
                                display: true
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Número de Casos'
                            },
                            beginAtZero: true,
                            grid: {
                                display: true
                            }
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    }
                }
            });

            // Guardar referencia del gráfico
            window.idvfcGrafica10Chart = chart;
        }

        // Función para crear la Tabla 12: Evolución mensual de la violencia homicida en Sinaloa (2024-2025)
        function createIDVFCSinaloaMensualTable() {
            const container = document.getElementById('tabla-sinaloa-mensual-idvfc');
            if (!container) {
                return;
            }

            // ✅ DATOS CORRECTOS: CSV IDVFC_NM_jul25.csv - SINALOA 2024-2025 (ENERO-JULIO)
            const labels = [
                'Enero 2024', 'Febrero 2024', 'Marzo 2024', 'Abril 2024', 'Mayo 2024', 'Junio 2024', 'Julio 2024', 'Agosto 2024',
                'Septiembre 2024', 'Octubre 2024', 'Noviembre 2024', 'Diciembre 2024',
                'Enero 2025', 'Febrero 2025', 'Marzo 2025', 'Abril 2025', 'Mayo 2025', 'Junio 2025', 'Julio 2025'
            ];
            
            // Datos reales extraídos del CSV IDVFC_NM_jul25.csv
            const sinaloaMensualData = {
                'Homicidio doloso': [52, 38, 34, 33, 42, 45, 50, 44, 143, 182, 174, 157, 147, 120, 135, 119, 165, 207, 170],
                'Homicidio culposo': [60, 55, 80, 65, 67, 58, 60, 43, 41, 51, 34, 43, 47, 57, 49, 54, 49, 50, 47],
                'Feminicidio': [1, 3, 1, 1, 2, 1, 4, 1, 1, 6, 2, 5, 0, 5, 2, 6, 2, 5, 4],
                'Otros delitos que atentan contra la vida y la integridad corporal': [64, 52, 58, 58, 77, 66, 73, 70, 59, 81, 54, 69, 50, 70, 83, 76, 83, 100, 49],
                'Total': [177, 148, 173, 157, 188, 170, 187, 158, 244, 320, 264, 274, 244, 252, 269, 255, 299, 362, 270]
            };

            const table = document.createElement('table');
            table.className = 'data-table';
            
            // Headers de la tabla
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            
            const headers = ['Año', 'Mes', 'Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos contra la vida', 'Total'];
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            // Datos de la tabla
            const tbody = document.createElement('tbody');
            
            // Crear filas con los datos reales
            labels.forEach((label, index) => {
                const tr = document.createElement('tr');
                
                // Extraer año y mes del label
                const [mes, año] = label.split(' ');
                
                // Año
                const tdAño = document.createElement('td');
                tdAño.textContent = año;
                tdAño.style.textAlign = 'left';
                tdAño.style.fontWeight = '500';
                tr.appendChild(tdAño);
                
                // Mes
                const tdMes = document.createElement('td');
                tdMes.textContent = mes;
                tdMes.style.textAlign = 'left';
                tdMes.style.fontWeight = '500';
                tr.appendChild(tdMes);
                
                // Homicidio doloso
                const tdHomicidioDoloso = document.createElement('td');
                const homicidioDoloso = sinaloaMensualData['Homicidio doloso'][index];
                tdHomicidioDoloso.textContent = homicidioDoloso.toLocaleString();
                tdHomicidioDoloso.style.textAlign = 'center';
                tr.appendChild(tdHomicidioDoloso);
                
                // Homicidio culposo
                const tdHomicidioCulposo = document.createElement('td');
                const homicidioCulposo = sinaloaMensualData['Homicidio culposo'][index];
                tdHomicidioCulposo.textContent = homicidioCulposo.toLocaleString();
                tdHomicidioCulposo.style.textAlign = 'center';
                tr.appendChild(tdHomicidioCulposo);
                
                // Feminicidio
                const tdFeminicidio = document.createElement('td');
                const feminicidio = sinaloaMensualData['Feminicidio'][index];
                tdFeminicidio.textContent = feminicidio.toLocaleString();
                tdFeminicidio.style.textAlign = 'center';
                tr.appendChild(tdFeminicidio);
                
                // Otros delitos
                const tdOtrosDelitos = document.createElement('td');
                const otrosDelitos = sinaloaMensualData['Otros delitos que atentan contra la vida y la integridad corporal'][index];
                tdOtrosDelitos.textContent = otrosDelitos.toLocaleString();
                tdOtrosDelitos.style.textAlign = 'center';
                tr.appendChild(tdOtrosDelitos);
                
                // Total
                const tdTotal = document.createElement('td');
                const total = sinaloaMensualData['Total'][index];
                tdTotal.textContent = total.toLocaleString();
                tdTotal.style.textAlign = 'center';
                tdTotal.style.fontWeight = 'bold';
                tdTotal.style.backgroundColor = '#f8f9fa';
                tr.appendChild(tdTotal);
                
                tbody.appendChild(tr);
            });
            
            table.appendChild(tbody);
            
            // Nota de fuente
            const sourceNote = document.createElement('p');
            sourceNote.style.fontSize = '12px';
            sourceNote.style.marginTop = '10px';
            sourceNote.style.color = '#666';
            sourceNote.innerHTML = '<strong>Fuente:</strong> SESNSP (IDVFC_NM_jul25.csv). Datos reales de violencia homicida en Sinaloa.';
            
            container.innerHTML = '';
            container.appendChild(table);
            container.appendChild(sourceNote);
        }

        // Configurar event listener para el selector de subtipos de la Gráfica 10
        function setupIDVFCSinaloaMensualSelector() {
            const selector = document.getElementById('grafica-10-subtipo-selector-idvfc');
            if (selector) {
                selector.addEventListener('change', function() {
                    updateIDVFCSinaloaMensualChart(this.value);
                });
            }
        }

        // Función para crear la gráfica IDVFC (EXACTA a la original)
        function createIDVFCChart() {
            const ctx = document.getElementById('chart-violencia-homicida-idvfc');
            if (!ctx) {
                return;
            }

            // Destruir gráfica existente si existe
            if (window.idvfcChart) {
                window.idvfcChart.destroy();
            }

            const años = [2019, 2020, 2021, 2022, 2023, 2024, 2025];
            const delitos = ['Homicidio doloso', 'Homicidio culposo', 'Feminicidio', 'Otros delitos que atentan contra la vida y la integridad corporal'];
            
            const totalRow = idvfcViolenciaHomicidaData[idvfcViolenciaHomicidaData.length - 1];
            const totales = años.map(año => parseInt(totalRow[año.toString()]) || 0);
            
            const datasets = [];
            
            delitos.forEach((delito, index) => {
                const delitoRow = idvfcViolenciaHomicidaData.find(row => row.Delito === delito);
                if (delitoRow) {
                    const colors = ['#2ecc71', '#e74c3c', '#3498db', '#f39c12'];
                    datasets.push({
                        label: delito === 'Otros delitos que atentan contra la vida y la integridad corporal' ? 'Otros delitos contra la vida' : delito,
                        data: años.map(año => parseInt(delitoRow[año.toString()]) || 0),
                        type: 'line',
                        borderColor: colors[index],
                        backgroundColor: colors[index],
                        borderWidth: 3,
                        fill: false,
                        tension: 0,
                        pointRadius: 0,
                        pointHoverRadius: 6,
                        order: index + 1
                    });
                }
            });
            
            datasets.push({
                label: 'Violencia homicida',
                data: totales,
                type: 'bar',
                backgroundColor: '#34495e',
                borderColor: '#34495e',
                borderWidth: 1,
                order: 5
            });

            const chart = new Chart(ctx, {
                type: 'bar',
                data: { labels: años, datasets: datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: { 
                        legend: { 
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            borderColor: '#3498db',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const value = new Intl.NumberFormat('es-MX').format(context.parsed.y);
                                    return `${context.dataset.label}: ${value}`;
                                }
                            }
                        }
                    },
                    scales: { 
                        y: { 
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Número de casos'
                            },
                            ticks: {
                                callback: function(value) {
                                    return new Intl.NumberFormat('es-MX').format(value);
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Año'
                            }
                        }
                    }
                }
            });

            window.idvfcChart = chart;
        }

        // Inicialización específica para la página IDVFC
        document.addEventListener('DOMContentLoaded', function() {
            // Crear gráfica principal IDVFC
            createIDVFCChart();
            
            // Crear tabla principal IDVFC
            createIDVFCTable();
            
            // Crear tabla de contribución al cambio
            createIDVFCContribucionTable();
            
            // Crear gráfica de cambios porcentuales anuales
            createIDVFCCambiosAnualesChart();
            
            // Crear tabla de cambios porcentuales anuales
            createIDVFCCambiosAnualesTable();
            
            // Crear gráfica mensual nacional
            createIDVFCMensualChart();
            
            // Crear tabla mensual nacional
            createIDVFCMensualTable();
            
            // Crear gráfica de cambios porcentuales mensuales
            createIDVFCCambiosMensualesChart();
            
            // Crear tabla de cambios porcentuales mensuales
            createIDVFCCambiosMensualesTable();
            
            // Crear gráfica de tasas por 100,000 habitantes
            createIDVFCRatesChart();
            
            // Crear tabla de tasas por 100,000 habitantes
            createIDVFCRatesTable();
            
            // Crear tabla estatal (2025)
            createIDVFCEstatalTable();
            
            // Crear gráfica de composición por estado (2025)
            createIDVFCEstatalChart();
            
            // Crear tabla de ranking mensual estatal (Top 10)
            createIDVFCRankingMensualTable();
            
            // Crear tabla de tasas de violencia homicida a nivel estatal (2025)
            createIDVFCEstatalRatesTable();
            
            // Crear tabla de Sinaloa anual por tipo de delito (2019-2025)
            createIDVFCSinaloaAnualTable();
            
            // Crear gráfica de Sinaloa anual
            createIDVFCSinaloaAnualChart();
            
            // Crear tabla de Sinaloa mensual
            createIDVFCSinaloaMensualTable();
            
            // Configurar selector de Sinaloa mensual
            setupIDVFCSinaloaMensualSelector();
            
            // Inicializar gráfica de composición por edad
            initSinaloaEdadComposicion();
            
            // Crear gráfica inicial con Homicidio doloso
            updateIDVFCSinaloaMensualChart('Homicidio doloso');
        });

        // Navegación suave entre pestañas
        document.addEventListener('DOMContentLoaded', function() {
            const tabLinks = document.querySelectorAll('.tab-link');
            
            tabLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    
                    // Permitir navegación a páginas externas o a index.html
                    if (href.includes('http') && !href.includes(window.location.hostname)) {
                        // Enlace externo - permitir navegación normal
                        return;
                    } else if (href === 'idvfc.html' || href === 'index.html') {
                        // Enlace a otra página - permitir navegación normal
                        return;
                    } else if (href.startsWith('#')) {
                        // Enlace interno con hash - manejar scroll
                        e.preventDefault();
                        
                        // Remover clase active de todas las pestañas
                        tabLinks.forEach(tab => tab.classList.remove('active'));
                        
                        // Agregar clase active a la pestaña clickeada
                        this.classList.add('active');
                        
                        // Scroll suave al elemento objetivo
                        const targetId = href.substring(1);
                        const targetElement = document.getElementById(targetId);
                        
                        if (targetElement) {
                            targetElement.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    }
                });
            });
            
            // Actualizar pestaña activa basada en scroll
            window.addEventListener('scroll', function() {
                const sections = document.querySelectorAll('section[id]');
                const scrollPos = window.scrollY + 100;
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.offsetHeight;
                    const sectionId = section.getAttribute('id');
                    
                    if (scrollPos >= sectionTop && scrollPos < sectionTop + sectionHeight) {
                        // Actualizar pestaña activa
                        tabLinks.forEach(tab => {
                            tab.classList.remove('active');
                            if (tab.getAttribute('href') === '#' + sectionId) {
                                tab.classList.add('active');
                            }
                        });
                    }
                });
            });
        });
    </script>

</body>
</html>
